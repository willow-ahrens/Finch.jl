<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Documentation Listing · Finch.jl</title><meta name="title" content="Documentation Listing · Finch.jl"/><meta property="og:title" content="Documentation Listing · Finch.jl"/><meta property="twitter:title" content="Documentation Listing · Finch.jl"/><meta name="description" content="Documentation for Finch.jl."/><meta property="og:description" content="Documentation for Finch.jl."/><meta property="twitter:description" content="Documentation for Finch.jl."/><meta property="og:url" content="https://willow-ahrens.github.io/Finch.jl/reference/listing/"/><meta property="twitter:url" content="https://willow-ahrens.github.io/Finch.jl/reference/listing/"/><link rel="canonical" href="https://willow-ahrens.github.io/Finch.jl/reference/listing/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Finch.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Finch.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Comprehensive Guides</span><ul><li><a class="tocitem" href="../../guides/calling_finch/">Calling Finch</a></li><li><a class="tocitem" href="../../guides/tensor_formats/">Tensor Formats</a></li><li><a class="tocitem" href="../../guides/sparse_utils/">Sparse and Structured Utilities</a></li><li><a class="tocitem" href="../../guides/finch_language/">The Finch Language</a></li><li><a class="tocitem" href="../../guides/dimensionalization/">Dimensionalization</a></li><li><a class="tocitem" href="../../guides/index_sugar/">Index Sugar</a></li><li><a class="tocitem" href="../../guides/mask_sugar/">Mask Sugar</a></li><li><a class="tocitem" href="../../guides/iteration_protocols/">Iteration Protocols</a></li><li><a class="tocitem" href="../../guides/user-defined_functions/">User-Defined Functions</a></li><li><a class="tocitem" href="../../guides/array_api/">High-Level Array API</a></li><li><a class="tocitem" href="../../guides/fileio/">FileIO</a></li><li><a class="tocitem" href="../../guides/interoperability/">Interoperability</a></li><li><a class="tocitem" href="../../guides/optimization_tips/">Optimization Tips</a></li><li><a class="tocitem" href="../../guides/benchmarking_tips/">Benchmarking Tips</a></li></ul></li><li><span class="tocitem">Technical Reference</span><ul><li class="is-active"><a class="tocitem" href>Documentation Listing</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Advanced Internal Details</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../internals/virtualization/">Virtualization</a></li><li><a class="tocitem" href="../internals/tensor_interface/">Tensor Interface</a></li><li><a class="tocitem" href="../internals/compiler_interface/">Compiler Interfaces</a></li><li><a class="tocitem" href="../internals/finch_notation/">Finch Notation</a></li><li><a class="tocitem" href="../internals/finch_logic/">Finch Logic</a></li></ul></li></ul></li><li><a class="tocitem" href="../../CONTRIBUTING/">Community and Contributions</a></li><li><span class="tocitem">Appendices and Additional Resources</span><ul><li><a class="tocitem" href="../../appendices/directory_structure/">Directory Structure</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Technical Reference</a></li><li class="is-active"><a href>Documentation Listing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Documentation Listing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/willow-ahrens/Finch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/willow-ahrens/Finch.jl/blob/main/docs/src/reference/listing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Documentation-Listing"><a class="docs-heading-anchor" href="#Documentation-Listing">Documentation Listing</a><a id="Documentation-Listing-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation-Listing" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.bandmask-reference-listing" href="#Finch.bandmask-reference-listing"><code>Finch.bandmask</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">bandmask</code></pre><p>A mask for a banded tensor, <code>bandmask[i, j, k] = j &lt;= i &lt;= k</code>. Note that this specializes each column for the cases where <code>i &lt; j</code>, <code>j &lt;= i &lt;= k</code>, and <code>k &lt; i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/masks.jl#L131-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.diagmask-reference-listing" href="#Finch.diagmask-reference-listing"><code>Finch.diagmask</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">diagmask</code></pre><p>A mask for a diagonal tensor, <code>diagmask[i, j] = i == j</code>. Note that this specializes each column for the cases where <code>i &lt; j</code>, <code>i == j</code>, and <code>i &gt; j</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/masks.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.lotrimask-reference-listing" href="#Finch.lotrimask-reference-listing"><code>Finch.lotrimask</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">lotrimask</code></pre><p>A mask for an upper triangular tensor, <code>lotrimask[i, j] = i &gt;= j</code>. Note that this specializes each column for the cases where <code>i &lt; j</code> and <code>i &gt;= j</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/masks.jl#L89-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.uptrimask-reference-listing" href="#Finch.uptrimask-reference-listing"><code>Finch.uptrimask</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">uptrimask</code></pre><p>A mask for an upper triangular tensor, <code>uptrimask[i, j] = i &lt;= j</code>. Note that this specializes each column for the cases where <code>i &lt;= j</code> and <code>i &gt; j</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/masks.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Core.Array-Tuple{Union{Finch.SwizzleArray, Tensor}}-reference-listing" href="#Core.Array-Tuple{Union{Finch.SwizzleArray, Tensor}}-reference-listing"><code>Core.Array</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Array(arr::Union{Tensor, SwizzleArray})</code></pre><p>Construct an array from a tensor or swizzle. May reuse memory, will usually densify the tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/abstract_arrays.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.DefaultLogicOptimizer-reference-listing" href="#Finch.DefaultLogicOptimizer-reference-listing"><code>Finch.DefaultLogicOptimizer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DefaultLogicOptimizer(ctx)</code></pre><p>The default optimizer for finch logic programs. Optimizes to a structure suitable for the LogicCompiler or LogicInterpreter, then calls <code>ctx</code> on the resulting program.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L586-L592">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.DenseData-reference-listing" href="#Finch.DenseData-reference-listing"><code>Finch.DenseData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DenseData(lvl)</code></pre><p>Represents a tensor <code>A</code> where each <code>A[:, ..., :, i]</code> is represented by <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.DenseLevel-reference-listing" href="#Finch.DenseLevel-reference-listing"><code>Finch.DenseLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DenseLevel{[Ti=Int]}(lvl, [dim])</code></pre><p>A subfiber of a dense level is an array which stores every slice <code>A[:, ..., :, i]</code> as a distinct subfiber in <code>lvl</code>. Optionally, <code>dim</code> is the size of the last dimension. <code>Ti</code> is the type of the indices used to index the level.</p><pre><code class="language-julia-repl hljs">julia&gt; ndims(Tensor(Dense(Element(0.0))))
1

julia&gt; ndims(Tensor(Dense(Dense(Element(0.0)))))
2

julia&gt; Tensor(Dense(Dense(Element(0.0))), [1 2; 3 4])
2×2-Tensor
└─ Dense [:,1:2]
   ├─ [:, 1]: Dense [1:2]
   │  ├─ [1]: 1.0
   │  └─ [2]: 3.0
   └─ [:, 2]: Dense [1:2]
      ├─ [1]: 2.0
      └─ [2]: 4.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/dense_levels.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.DenseRLELevel-reference-listing" href="#Finch.DenseRLELevel-reference-listing"><code>Finch.DenseRLELevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DenseRLELevel{[Ti=Int], [Ptr, Right]}(lvl, [dim], [merge = true])</code></pre><p>The dense RLE level represent runs of equivalent slices <code>A[:, ..., :, i]</code>. A sorted list is used to record the right endpoint of each run. Optionally, <code>dim</code> is the size of the last dimension.</p><p><code>Ti</code> is the type of the last tensor index, and <code>Tp</code> is the type used for positions in the level. The types <code>Ptr</code> and <code>Right</code> are the types of the arrays used to store positions and endpoints.</p><p>The <code>merge</code> keyword argument is used to specify whether the level should merge duplicate consecutive runs.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(DenseRLELevel(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: DenseRLE (0.0) [1:3]
   │  ├─ [1:1]: 10.0
   │  ├─ [2:2]: 30.0
   │  └─ [3:3]: 0.0
   ├─ [:, 2]: DenseRLE (0.0) [1:3]
   │  └─ [1:3]: 0.0
   └─ [:, 3]: DenseRLE (0.0) [1:3]
      ├─ [1:1]: 20.0
      ├─ [2:2]: 0.0
      └─ [3:3]: 40.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/dense_rle_levels.jl#L1-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ElementData-reference-listing" href="#Finch.ElementData-reference-listing"><code>Finch.ElementData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ElementData(fill_value, eltype)</code></pre><p>Represents a scalar element of type <code>eltype</code> and fill<em>value `fill</em>value`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ElementLevel-reference-listing" href="#Finch.ElementLevel-reference-listing"><code>Finch.ElementLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ElementLevel{Vf, [Tv=typeof(Vf)], [Tp=Int], [Val]}()</code></pre><p>A subfiber of an element level is a scalar of type <code>Tv</code>, initialized to <code>Vf</code>. <code>Vf</code> may optionally be given as the first argument.</p><p>The data is stored in a vector of type <code>Val</code> with <code>eltype(Val) = Tv</code>. The type <code>Tp</code> is the index type used to access Val.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(Element(0.0)), [1, 2, 3])
3-Tensor
└─ Dense [1:3]
   ├─ [1]: 1.0
   ├─ [2]: 2.0
   └─ [3]: 3.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/element_levels.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ExtrudeData-reference-listing" href="#Finch.ExtrudeData-reference-listing"><code>Finch.ExtrudeData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExtrudeData(lvl)</code></pre><p>Represents a tensor <code>A</code> where <code>A[:, ..., :, 1]</code> is the only slice, and is represented by <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L49-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchCompiler-reference-listing" href="#Finch.FinchCompiler-reference-listing"><code>Finch.FinchCompiler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FinchCompiler</code></pre><p>The core compiler for Finch, lowering canonicalized Finch IR to Julia code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/lower.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.HollowData-reference-listing" href="#Finch.HollowData-reference-listing"><code>Finch.HollowData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HollowData(lvl)</code></pre><p>Represents a tensor which is represented by <code>lvl</code> but is sometimes entirely <code>fill_value(lvl)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Infinitesimal-reference-listing" href="#Finch.Infinitesimal-reference-listing"><code>Finch.Infinitesimal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Infintesimal(s)</code></pre><p>The Infintesimal type represents an infinitestimal number.  The sign field is used to represent positive, negative, or zero in this number system.</p><p>```jl-doctest julia&gt; tiny() +0</p><p>julia&gt; positive_tiny() +ϵ</p><p>julia&gt; negative_tiny() -ϵ</p><p>julia&gt; positive<em>tiny() + negative</em>tiny() +0</p><p>julia&gt; positive_tiny() * 2 +ϵ</p><p>julia&gt; positive<em>tiny() * negative</em>tiny() -ϵ</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/limits.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.JuliaContext-reference-listing" href="#Finch.JuliaContext-reference-listing"><code>Finch.JuliaContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JuliaContext</code></pre><p>A context for compiling Julia code, managing side effects, parallelism, and variable names in the generated code of the executing environment.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Limit-reference-listing" href="#Finch.Limit-reference-listing"><code>Finch.Limit</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Limit{T}(x, s)</code></pre><p>The Limit type represents endpoints of closed and open intervals.  The val field is the value of the endpoint.  The sign field is used to represent the openness/closedness of the interval endpoint, using an Infinitesmal.</p><p>```jl-doctest julia&gt; limit(1.0) 1.0+0</p><p>julia&gt; plus_eps(1.0) 1.0+ϵ</p><p>julia&gt; minus_eps(1.0) 1.0-ϵ</p><p>julia&gt; plus<em>eps(1.0) + minus</em>eps(1.0) 2.0+0.0</p><p>julia&gt; plus_eps(1.0) * 2 2.0+2.0ϵ</p><p>julia&gt; plus<em>eps(1.0) * minus</em>eps(1.0) 1.0-1.0ϵ</p><p>julia&gt; plus<em>eps(-1.0) * minus</em>eps(1.0) -1.0+2.0ϵ</p><p>julia&gt; 1.0 &lt; plus_eps(1.0) true</p><p>julia&gt; 1.0 &lt; minus_eps(1.0) false</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/limits.jl#L91-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.LogicCompiler-reference-listing" href="#Finch.LogicCompiler-reference-listing"><code>Finch.LogicCompiler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LogicCompiler</code></pre><p>The LogicCompiler is a simple compiler for finch logic programs. The interpreter is only capable of executing programs of the form:       REORDER := reorder(relabel(ALIAS, FIELD...), FIELD...)        ACCESS := reorder(relabel(ALIAS, idxs<em>1::FIELD...), idxs</em>2::FIELD...) where issubsequence(idxs<em>1, idxs</em>2)     POINTWISE := ACCESS | mapjoin(IMMEDIATE, POINTWISE...) | reorder(IMMEDIATE, FIELD...) | IMMEDIATE     MAPREDUCE := POINTWISE | aggregate(IMMEDIATE, IMMEDIATE, POINTWISE, FIELD...)        TABLE  := table(IMMEDIATE | DEFERRED, FIELD...) COMPUTE<em>QUERY := query(ALIAS, reformat(IMMEDIATE, arg::(REORDER | MAPREDUCE)))   INPUT</em>QUERY := query(ALIAS, TABLE)          STEP := COMPUTE<em>QUERY | INPUT</em>QUERY | produces(ALIAS...)          ROOT := PLAN(STEP...)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicCompiler.jl#L165-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.LogicExecutor-reference-listing" href="#Finch.LogicExecutor-reference-listing"><code>Finch.LogicExecutor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LogicExecutor(ctx, verbose=false)</code></pre><p>Executes a logic program by compiling it with the given compiler <code>ctx</code>. Compiled codes are cached, and are only compiled once for each program with the same structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicExecutor.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.LogicExecutorCode-reference-listing" href="#Finch.LogicExecutorCode-reference-listing"><code>Finch.LogicExecutorCode</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LogicExecutorCode(ctx)</code></pre><p>Return the code that would normally be used by the LogicExecutor to run a program.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicExecutor.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.LogicInterpreter-reference-listing" href="#Finch.LogicInterpreter-reference-listing"><code>Finch.LogicInterpreter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LogicInterpreter(scope = Dict(), verbose = false, mode = :fast)</code></pre><p>The LogicInterpreter is a simple interpreter for finch logic programs. The interpreter is only capable of executing programs of the form:       REORDER := reorder(relabel(ALIAS, FIELD...), FIELD...)        ACCESS := reorder(relabel(ALIAS, idxs<em>1::FIELD...), idxs</em>2::FIELD...) where issubsequence(idxs<em>1, idxs</em>2)     POINTWISE := ACCESS | mapjoin(IMMEDIATE, POINTWISE...) | reorder(IMMEDIATE, FIELD...) | IMMEDIATE     MAPREDUCE := POINTWISE | aggregate(IMMEDIATE, IMMEDIATE, POINTWISE, FIELD...)        TABLE  := table(IMMEDIATE, FIELD...) COMPUTE<em>QUERY := query(ALIAS, reformat(IMMEDIATE, arg::(REORDER | MAPREDUCE)))   INPUT</em>QUERY := query(ALIAS, TABLE)          STEP := COMPUTE<em>QUERY | INPUT</em>QUERY | produces(ALIAS...)          ROOT := PLAN(STEP...)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicInterpreter.jl#L111-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Namespace-reference-listing" href="#Finch.Namespace-reference-listing"><code>Finch.Namespace</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Namespace</code></pre><p>A namespace for managing variable names and aesthetic fresh variable generation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.PatternLevel-reference-listing" href="#Finch.PatternLevel-reference-listing"><code>Finch.PatternLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PatternLevel{[Tp=Int]}()</code></pre><p>A subfiber of a pattern level is the Boolean value true, but it&#39;s <code>fill_value</code> is false. PatternLevels are used to create tensors that represent which values are stored by other fibers. See <a href="../../guides/sparse_utils/#Finch.pattern!"><code>pattern!</code></a> for usage examples.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(Pattern()), 3)
3-Tensor
└─ Dense [1:3]
   ├─ [1]: true
   ├─ [2]: true
   └─ [3]: true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/pattern_levels.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.RepeatData-reference-listing" href="#Finch.RepeatData-reference-listing"><code>Finch.RepeatData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RepeatData(lvl)</code></pre><p>Represents a tensor <code>A</code> where <code>A[:, ..., :, i]</code> is sometimes entirely fill_value(lvl) and is sometimes represented by repeated runs of <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ScopeContext-reference-listing" href="#Finch.ScopeContext-reference-listing"><code>Finch.ScopeContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ScopeContext</code></pre><p>A context for managing variable bindings and tensor modes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SeparateLevel-reference-listing" href="#Finch.SeparateLevel-reference-listing"><code>Finch.SeparateLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SeparateLevel{Lvl, [Val]}()</code></pre><p>A subfiber of a Separate level is a separate tensor of type <code>Lvl</code>, in it&#39;s own memory space.</p><p>Each sublevel is stored in a vector of type <code>Val</code> with <code>eltype(Val) = Lvl</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(Separate(Element(0.0))), [1, 2, 3])
3-Tensor
└─ Dense [1:3]
   ├─ [1]: Pointer -&gt;
   │  └─ 1.0
   ├─ [2]: Pointer -&gt;
   │  └─ 2.0
   └─ [3]: Pointer -&gt;
      └─ 3.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/separate_levels.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseBandLevel-reference-listing" href="#Finch.SparseBandLevel-reference-listing"><code>Finch.SparseBandLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>SparseBandLevel{[Ti=Int], [Ptr, Idx, Ofs]}(lvl, [dim])</p><p>Like the <a href="../../guides/tensor_formats/#Finch.SparseVBLLevel"><code>SparseVBLLevel</code></a>, but stores only a single block, and fills in zeros.</p><p>```jldoctest julia&gt; Tensor(Dense(SparseBand(Element(0.0))), [10 0 20; 30 40 0; 0 0 50]) Dense [:,1:3] ├─[:,1]: SparseList (0.0) [1:3] │ ├─[1]: 10.0 │ ├─[2]: 30.0 ├─[:,2]: SparseList (0.0) [1:3] ├─[:,3]: SparseList (0.0) [1:3] │ ├─[1]: 20.0 │ ├─[3]: 40.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_band_levels.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseByteMapLevel-reference-listing" href="#Finch.SparseByteMapLevel-reference-listing"><code>Finch.SparseByteMapLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseByteMapLevel{[Ti=Int], [Ptr, Tbl]}(lvl, [dims])</code></pre><p>Like the <a href="../../guides/tensor_formats/#Finch.SparseListLevel"><code>SparseListLevel</code></a>, but a dense bitmap is used to encode which slices are stored. This allows the ByteMap level to support random access.</p><p><code>Ti</code> is the type of the last tensor index, and <code>Tp</code> is the type used for positions in the level.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(SparseByteMap(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: SparseByteMap (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   ├─ [:, 2]: SparseByteMap (0.0) [1:3]
   └─ [:, 3]: SparseByteMap (0.0) [1:3]
      ├─ [1]: 0.0
      └─ [3]: 0.0

julia&gt; Tensor(SparseByteMap(SparseByteMap(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ SparseByteMap (0.0) [:,1:3]
   ├─ [:, 1]: SparseByteMap (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   └─ [:, 3]: SparseByteMap (0.0) [1:3]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_bytemap_levels.jl#L1-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseCOOLevel-reference-listing" href="#Finch.SparseCOOLevel-reference-listing"><code>Finch.SparseCOOLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseCOOLevel{[N], [TI=Tuple{Int...}], [Ptr, Tbl]}(lvl, [dims])</code></pre><p>A subfiber of a sparse level does not need to represent slices which are entirely <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a>. Instead, only potentially non-fill slices are stored as subfibers in <code>lvl</code>. The sparse coo level corresponds to <code>N</code> indices in the subfiber, so fibers in the sublevel are the slices <code>A[:, ..., :, i_1, ..., i_n]</code>.  A set of <code>N</code> lists (one for each index) are used to record which slices are stored. The coordinates (sets of <code>N</code> indices) are sorted in column major order.  Optionally, <code>dims</code> are the sizes of the last dimensions.</p><p><code>TI</code> is the type of the last <code>N</code> tensor indices, and <code>Tp</code> is the type used for positions in the level.</p><p>The type <code>Tbl</code> is an NTuple type where each entry k is a subtype <code>AbstractVector{TI[k]}</code>.</p><p>The type <code>Ptr</code> is the type for the pointer array.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(SparseCOO{1}(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: SparseCOO{1} (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   ├─ [:, 2]: SparseCOO{1} (0.0) [1:3]
   └─ [:, 3]: SparseCOO{1} (0.0) [1:3]
      ├─ [1]: 20.0
      └─ [3]: 40.0

julia&gt; Tensor(SparseCOO{2}(Element(0.0)), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ SparseCOO{2} (0.0) [:,1:3]
   ├─ [1, 1]: 10.0
   ├─ [2, 1]: 30.0
   ├─ [1, 3]: 20.0
   └─ [3, 3]: 40.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_coo_levels.jl#L1-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseData-reference-listing" href="#Finch.SparseData-reference-listing"><code>Finch.SparseData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseData(lvl)</code></pre><p>Represents a tensor <code>A</code> where <code>A[:, ..., :, i]</code> is sometimes entirely fill_value(lvl) and is sometimes represented by <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseDictLevel-reference-listing" href="#Finch.SparseDictLevel-reference-listing"><code>Finch.SparseDictLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseDictLevel{[Ti=Int], [Tp=Int], [Ptr, Idx, Val, Tbl, Pool=Dict]}(lvl, [dim])</code></pre><p>A subfiber of a sparse level does not need to represent slices <code>A[:, ..., :, i]</code> which are entirely <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a>. Instead, only potentially non-fill slices are stored as subfibers in <code>lvl</code>.  A datastructure specified by Tbl is used to record which slices are stored. Optionally, <code>dim</code> is the size of the last dimension.</p><p><code>Ti</code> is the type of the last fiber index, and <code>Tp</code> is the type used for positions in the level. The types <code>Ptr</code> and <code>Idx</code> are the types of the arrays used to store positions and indicies.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(SparseDict(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: SparseDict (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   ├─ [:, 2]: SparseDict (0.0) [1:3]
   └─ [:, 3]: SparseDict (0.0) [1:3]
      ├─ [1]: 20.0
      └─ [3]: 40.0

julia&gt; Tensor(SparseDict(SparseDict(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ SparseDict (0.0) [:,1:3]
   ├─ [:, 1]: SparseDict (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   └─ [:, 3]: SparseDict (0.0) [1:3]
      ├─ [1]: 20.0
      └─ [3]: 40.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_dict_levels.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseIntervalLevel-reference-listing" href="#Finch.SparseIntervalLevel-reference-listing"><code>Finch.SparseIntervalLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseIntervalLevel{[Ti=Int], [Ptr, Left, Right]}(lvl, [dim])</code></pre><p>The single RLE level represent runs of equivalent slices <code>A[:, ..., :, i]</code> which are not entirely <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a>. A main difference compared to SparseRLE level is that SparseInterval level only stores a &#39;single&#39; non-fill run. It emits an error if the program tries to write multiple (&gt;=2) runs into SparseInterval.</p><p><code>Ti</code> is the type of the last tensor index. The types <code>Ptr</code>, <code>Left</code>, and &#39;Right&#39; are the types of the arrays used to store positions and endpoints.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(SparseInterval(Element(0)), [0, 10, 0])
3-Tensor
└─ SparseInterval (0) [1:3]
   └─ [2:2]: 10

julia&gt; x = Tensor(SparseInterval(Element(0)), 10);

julia&gt; @finch begin for i = extent(3,6); x[~i] = 1 end end;

julia&gt; x
10-Tensor
└─ SparseInterval (0) [1:10]
   └─ [3:6]: 1
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_interval_levels.jl#L1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseListLevel-reference-listing" href="#Finch.SparseListLevel-reference-listing"><code>Finch.SparseListLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseListLevel{[Ti=Int], [Ptr, Idx]}(lvl, [dim])</code></pre><p>A subfiber of a sparse level does not need to represent slices <code>A[:, ..., :, i]</code> which are entirely <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a>. Instead, only potentially non-fill slices are stored as subfibers in <code>lvl</code>.  A sorted list is used to record which slices are stored. Optionally, <code>dim</code> is the size of the last dimension.</p><p><code>Ti</code> is the type of the last tensor index, and <code>Tp</code> is the type used for positions in the level. The types <code>Ptr</code> and <code>Idx</code> are the types of the arrays used to store positions and indicies.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(SparseList(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: SparseList (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   ├─ [:, 2]: SparseList (0.0) [1:3]
   └─ [:, 3]: SparseList (0.0) [1:3]
      ├─ [1]: 20.0
      └─ [3]: 40.0

julia&gt; Tensor(SparseList(SparseList(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ SparseList (0.0) [:,1:3]
   ├─ [:, 1]: SparseList (0.0) [1:3]
   │  ├─ [1]: 10.0
   │  └─ [2]: 30.0
   └─ [:, 3]: SparseList (0.0) [1:3]
      ├─ [1]: 20.0
      └─ [3]: 40.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_list_levels.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparsePointLevel-reference-listing" href="#Finch.SparsePointLevel-reference-listing"><code>Finch.SparsePointLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparsePointLevel{[Ti=Int], [Ptr, Idx]}(lvl, [dim])</code></pre><p>A subfiber of a SparsePoint level does not need to represent slices <code>A[:, ..., :, i]</code> which are entirely <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a>. Instead, only potentially non-fill slices are stored as subfibers in <code>lvl</code>. A main difference compared to SparseList level is that SparsePoint level only stores a &#39;single&#39; non-fill slice. It emits an error if the program tries to write multiple (&gt;=2) coordinates into SparsePoint.</p><p><code>Ti</code> is the type of the last tensor index. The types <code>Ptr</code> and <code>Idx</code> are the types of the arrays used to store positions and indicies.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(SparsePoint(Element(0.0))), [10 0 0; 0 20 0; 0 0 30])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: SparsePoint (0.0) [1:3]
   │  └─ 10.0
   ├─ [:, 2]: SparsePoint (0.0) [1:3]
   │  └─ 20.0
   └─ [:, 3]: SparsePoint (0.0) [1:3]
      └─ 30.0

julia&gt; Tensor(SparsePoint(Dense(Element(0.0))), [0 0 0; 0 0 30; 0 0 30])
3×3-Tensor
└─ SparsePoint (0.0) [:,1:3]
   └─ Dense [1:3]
      ├─ [1]: 0.0
      ├─ [2]: 30.0
      └─ [3]: 30.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_point_levels.jl#L1-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseRLELevel-reference-listing" href="#Finch.SparseRLELevel-reference-listing"><code>Finch.SparseRLELevel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SparseRLELevel{[Ti=Int], [Ptr, Left, Right]}(lvl, [dim]; [merge = true])</code></pre><p>The sparse RLE level represent runs of equivalent slices <code>A[:, ..., :, i]</code> which are not entirely <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a>. A sorted list is used to record the left and right endpoints of each run. Optionally, <code>dim</code> is the size of the last dimension.</p><p><code>Ti</code> is the type of the last tensor index, and <code>Tp</code> is the type used for positions in the level. The types <code>Ptr</code>, <code>Left</code>, and <code>Right</code> are the types of the arrays used to store positions and endpoints.</p><p>The <code>merge</code> keyword argument is used to specify whether the level should merge duplicate consecutive runs.</p><pre><code class="language-julia-repl hljs">julia&gt; Tensor(Dense(SparseRLELevel(Element(0.0))), [10 0 20; 30 0 0; 0 0 40])
3×3-Tensor
└─ Dense [:,1:3]
   ├─ [:, 1]: SparseRLE (0.0) [1:3]
   │  ├─ [1:1]: 10.0
   │  └─ [2:2]: 30.0
   ├─ [:, 2]: SparseRLE (0.0) [1:3]
   └─ [:, 3]: SparseRLE (0.0) [1:3]
      ├─ [1:1]: 20.0
      └─ [3:3]: 40.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_rle_levels.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SparseVBLLevel-reference-listing" href="#Finch.SparseVBLLevel-reference-listing"><code>Finch.SparseVBLLevel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>SparseVBLLevel{[Ti=Int], [Ptr, Idx, Ofs]}(lvl, [dim])</p><p>Like the <a href="../../guides/tensor_formats/#Finch.SparseListLevel"><code>SparseListLevel</code></a>, but contiguous subfibers are stored together in blocks.</p><p>```jldoctest julia&gt; Tensor(Dense(SparseVBL(Element(0.0))), [10 0 20; 30 0 0; 0 0 40]) Dense [:,1:3] ├─[:,1]: SparseList (0.0) [1:3] │ ├─[1]: 10.0 │ ├─[2]: 30.0 ├─[:,2]: SparseList (0.0) [1:3] ├─[:,3]: SparseList (0.0) [1:3] │ ├─[1]: 20.0 │ ├─[3]: 40.0</p><p>julia&gt; Tensor(SparseVBL(SparseVBL(Element(0.0))), [10 0 20; 30 0 0; 0 0 40]) SparseList (0.0) [:,1:3] ├─[:,1]: SparseList (0.0) [1:3] │ ├─[1]: 10.0 │ ├─[2]: 30.0 ├─[:,3]: SparseList (0.0) [1:3] │ ├─[1]: 20.0 │ ├─[3]: 40.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/sparse_vbl_levels.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.StaticHash-reference-listing" href="#Finch.StaticHash-reference-listing"><code>Finch.StaticHash</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StaticHash</code></pre><p>A hash function which is static, i.e. the hashes are the same when objects are hashed in the same order. The hash is used to memoize the results of simplification and proof rules.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L226-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SubFiber-reference-listing" href="#Finch.SubFiber-reference-listing"><code>Finch.SubFiber</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SubFiber(lvl, pos)</code></pre><p><code>SubFiber</code> represents a tensor at position <code>pos</code> within <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SymbolicContext-reference-listing" href="#Finch.SymbolicContext-reference-listing"><code>Finch.SymbolicContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SymbolicContext</code></pre><p>A compiler context for symbolic computation, defined on an algebra.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L239-L243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Tensor-Tuple{Finch.AbstractLevel, Any}-reference-listing" href="#Finch.Tensor-Tuple{Finch.AbstractLevel, Any}-reference-listing"><code>Finch.Tensor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Tensor(lvl, arr)</code></pre><p>Construct a <code>Tensor</code> and initialize it to the contents of <code>arr</code>. To explicitly copy into a tensor, use @ref[<code>copyto!</code>]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L37-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Tensor-Tuple{Finch.AbstractLevel, Vararg{Number}}-reference-listing" href="#Finch.Tensor-Tuple{Finch.AbstractLevel, Vararg{Number}}-reference-listing"><code>Finch.Tensor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Tensor(lvl, [undef], dims...)</code></pre><p>Construct a <code>Tensor</code> of size <code>dims</code>, and initialize to <code>undef</code>, potentially allocating memory.  Here <code>undef</code> is the <code>UndefInitializer</code> singleton type. <code>dims...</code> may be a variable number of dimensions or a tuple of dimensions, but it must correspond to the number of dimensions in <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L24-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Tensor-Tuple{Lvl} where Lvl&lt;:Finch.AbstractLevel-reference-listing" href="#Finch.Tensor-Tuple{Lvl} where Lvl&lt;:Finch.AbstractLevel-reference-listing"><code>Finch.Tensor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Tensor(lvl)</code></pre><p>Construct a <code>Tensor</code> using the tensor level storage <code>lvl</code>. No initialization of storage is performed, it is assumed that position 1 of <code>lvl</code> corresponds to a valid tensor, and <code>lvl</code> will be wrapped as-is. Call a different constructor to initialize the storage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L14-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Tensor-Union{Tuple{AbstractArray{Tv, N}}, Tuple{N}, Tuple{Tv}, Tuple{AbstractArray{Tv, N}, Tv}} where {Tv, N}-reference-listing" href="#Finch.Tensor-Union{Tuple{AbstractArray{Tv, N}}, Tuple{N}, Tuple{Tv}, Tuple{AbstractArray{Tv, N}, Tv}} where {Tv, N}-reference-listing"><code>Finch.Tensor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Tensor(arr, [init = zero(eltype(arr))])</code></pre><p>Copy an array-like object <code>arr</code> into a corresponding, similar <code>Tensor</code> datastructure. Uses <code>init</code> as an initial value. May reuse memory when possible. To explicitly copy into a tensor, use @ref[<code>copyto!</code>].</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; println(summary(Tensor(sparse([1 0; 0 1]))))
2×2 Tensor(Dense(SparseList(Element(0))))

julia&gt; println(summary(Tensor(ones(3, 2, 4))))
3×2×4 Tensor(Dense(Dense(Dense(Element(0.0)))))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L46-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Tensor-reference-listing" href="#Finch.Tensor-reference-listing"><code>Finch.Tensor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Tensor{Lvl} &lt;: AbstractFiber{Lvl}</code></pre><p>The multidimensional array type used by <code>Finch</code>. <code>Tensor</code> is a thin wrapper around the hierarchical level storage of type <code>Lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.resize!-Tuple{Tensor, Vararg{Any}}-reference-listing" href="#Base.resize!-Tuple{Tensor, Vararg{Any}}-reference-listing"><code>Base.resize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">resize!(fbr, dims...)</code></pre><p>Set the shape of <code>fbr</code> equal to <code>dims</code>. May reuse memory and render the original tensor unusable when modified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L195-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.aggregate_rep-NTuple{4, Any}-reference-listing" href="#Finch.aggregate_rep-NTuple{4, Any}-reference-listing"><code>Finch.aggregate_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aggregate_rep(op, init, tns, dims)</code></pre><p>Return a trait object representing the result of reducing a tensor represented by <code>tns</code> on <code>dims</code> by <code>op</code> starting at <code>init</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L265-L270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.aquire_lock!-Tuple{Finch.AbstractDevice, Any}-reference-listing" href="#Finch.aquire_lock!-Tuple{Finch.AbstractDevice, Any}-reference-listing"><code>Finch.aquire_lock!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aquire_lock!(dev::AbstractDevice, val)</code></pre><p>Lock the lock, val, on the device dev, waiting until it can acquire lock.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/architecture.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.assemble_level!-reference-listing" href="#Finch.assemble_level!-reference-listing"><code>Finch.assemble_level!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">assemble_level!(ctx, lvl, pos, new_pos)</code></pre><p>Assemble and positions <code>pos+1:new_pos</code> in <code>lvl</code>, assuming positions <code>1:pos</code> were previously assembled.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L86-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.bspread-reference-listing" href="#Finch.bspread-reference-listing"><code>Finch.bspread</code></a> — <span class="docstring-category">Function</span></header><section><div><p>bspread(::AbstractString) bspread(::HDF5.File) bspread(::NPYPath)</p><p>Read the <a href="https://github.com/GraphBLAS/binsparse-specification">Binsparse</a> file into a Finch tensor.</p><p>Supported file extensions are:</p><ul><li><code>.bsp.h5</code>: HDF5 file format (<a href="https://github.com/JuliaIO/HDF5.jl">HDF5</a> must be loaded)</li><li><code>.bspnpy</code>: NumPy and JSON directory format (<a href="https://github.com/fhs/NPZ.jl">NPZ</a> must be loaded)</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"></div></div><p>The Binsparse spec is under development. Additionally, this function may not be fully conformant. Please file bug reports if you see anything amiss.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/binsparse.jl#L22-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.bspwrite-reference-listing" href="#Finch.bspwrite-reference-listing"><code>Finch.bspwrite</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bspwrite(::AbstractString, tns)
bspwrite(::HDF5.File, tns)
bspwrite(::NPYPath, tns)</code></pre><p>Write the Finch tensor to a file using <a href="https://github.com/GraphBLAS/binsparse-specification">Binsparse</a> file format.</p><p>Supported file extensions are:</p><ul><li><code>.bsp.h5</code>: HDF5 file format (<a href="https://github.com/JuliaIO/HDF5.jl">HDF5</a> must be loaded)</li><li><code>.bspnpy</code>: NumPy and JSON directory format (<a href="https://github.com/fhs/NPZ.jl">NPZ</a> must be loaded)</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Binsparse spec is under development. Additionally, this function may not be fully conformant. Please file bug reports if you see anything amiss.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/binsparse.jl#L3-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.cache_deferred!-Tuple{Any, Finch.FinchLogic.LogicNode}-reference-listing" href="#Finch.cache_deferred!-Tuple{Any, Finch.FinchLogic.LogicNode}-reference-listing"><code>Finch.cache_deferred!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cache_deferred(ctx, root::LogicNode, seen)</code></pre><p>Replace deferred expressions with simpler expressions, and cache their evaluation in the preamble.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicExecutor.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.choose-Tuple{Any}-reference-listing" href="#Finch.choose-Tuple{Any}-reference-listing"><code>Finch.choose</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">choose(z)(a, b)</code></pre><p><code>choose(z)</code> is a function which returns whichever of <code>a</code> or <code>b</code> is not <a href="https://docs.julialang.org/en/v1/base/base/#Base.isequal">isequal</a> to <code>z</code>. If neither are <code>z</code>, then return <code>a</code>. Useful for getting the first nonfill value in a sparse array.</p><pre><code class="language-julia-repl hljs">julia&gt; a = Tensor(SparseList(Element(0.0)), [0, 1.1, 0, 4.4, 0])
5-Tensor
└─ SparseList (0.0) [1:5]
   ├─ [2]: 1.1
   └─ [4]: 4.4

julia&gt; x = Scalar(0.0); @finch for i=_; x[] &lt;&lt;choose(1.1)&gt;&gt;= a[i] end;

julia&gt; x[]
0.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L12-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.chunkmask-reference-listing" href="#Finch.chunkmask-reference-listing"><code>Finch.chunkmask</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">chunkmask(b)</code></pre><p>A mask for a chunked tensor, <code>chunkmask[i, j] = b * (j - 1) &lt; i &lt;= b * j</code>. Note that this specializes each column for the cases where <code>i &lt; b * (j - 1)</code>, `b * (j</p><ul><li><ol><li>&lt; i &lt;= b * j<code>, and</code>b * j &lt; i`.</li></ol></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/masks.jl#L245-L251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.cld_nothrow-Tuple{Any, Any}-reference-listing" href="#Finch.cld_nothrow-Tuple{Any, Any}-reference-listing"><code>Finch.cld_nothrow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cld_nothrow(x, y)</code></pre><p>Returns <code>cld(x, y)</code> normally, returns zero and issues a warning if <code>y</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L134-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.collapse_rep-Tuple{Any}-reference-listing" href="#Finch.collapse_rep-Tuple{Any}-reference-listing"><code>Finch.collapse_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">collapse_rep(tns)</code></pre><p>Normalize a trait object to collapse subfiber information into the parent tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.collapsed-NTuple{6, Any}-reference-listing" href="#Finch.collapsed-NTuple{6, Any}-reference-listing"><code>Finch.collapsed</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">collapsed(algebra, f, idx, ext, node)</code></pre><p>Return collapsed expression with respect to f.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L181-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.combinedim-Tuple{Any, Any, Any}-reference-listing" href="#Finch.combinedim-Tuple{Any, Any, Any}-reference-listing"><code>Finch.combinedim</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">combinedim(ctx, a, b)</code></pre><p>Combine the two dimensions <code>a</code> and <code>b</code>.  To avoid ambiguity, only define one of</p><pre><code class="nohighlight hljs">combinedim(ctx, ::A, ::B)
combinedim(ctx, ::B, ::A)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/dimensions.jl#L24-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.compute-Tuple-reference-listing" href="#Finch.compute-Tuple-reference-listing"><code>Finch.compute</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute(args..., ctx=default_scheduler()) -&gt; Any</code></pre><p>Compute the value of a lazy tensor. The result is the argument itself, or a tuple of arguments if multiple arguments are passed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/lazy.jl#L487-L492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.concordize-Tuple{Any}-reference-listing" href="#Finch.concordize-Tuple{Any}-reference-listing"><code>Finch.concordize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">concordize(root)</code></pre><p>Accepts a program of the following form:</p><pre><code class="nohighlight hljs">        TABLE := table(IMMEDIATE, FIELD...)
       ACCESS := reorder(relabel(ALIAS, FIELD...), FIELD...)
      COMPUTE := ACCESS |
                 mapjoin(IMMEDIATE, COMPUTE...) |
                 aggregate(IMMEDIATE, IMMEDIATE, COMPUTE, FIELD...) |
                 reformat(IMMEDIATE, COMPUTE) |
                 IMMEDIATE
COMPUTE_QUERY := query(ALIAS, COMPUTE)
  INPUT_QUERY := query(ALIAS, TABLE)
         STEP := COMPUTE_QUERY | INPUT_QUERY | produces((ALIAS | ACCESS)...)
         ROOT := PLAN(STEP...)</code></pre><p>Inserts permutation statements of the form <code>query(ALIAS, reorder(ALIAS, FIELD...))</code> and updates <code>relabel</code>s so that they match their containing <code>reorder</code>s. Modified <code>ACCESS</code> statements match the form:</p><pre><code class="nohighlight hljs">ACCESS := reorder(relabel(ALIAS, idxs_1::FIELD...), idxs_2::FIELD...) where issubsequence(idxs_1, idxs_2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L263-L289">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.concordize-Tuple{Finch.AbstractCompiler, Any}-reference-listing" href="#Finch.concordize-Tuple{Finch.AbstractCompiler, Any}-reference-listing"><code>Finch.concordize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">concordize(ctx, root)</code></pre><p>A raw index is an index expression consisting of a single index node (i.e. <code>A[i]</code> as opposed to <code>A[i + 1]</code>). A Finch program is concordant when all indices are raw and column major with respect to the program loop ordering.  The <code>concordize</code> transformation ensures that tensor indices are concordant by inserting loops and lifting index expressions or transposed indices into the loop bounds.</p><p>For example,</p><pre><code class="nohighlight hljs">@finch for i = :
    b[] += A[f(i)]
end</code></pre><p>becomes</p><pre><code class="nohighlight hljs">@finch for i = :
    t = f(i)
    for s = t:t
        b[] += A[s]
    end
end</code></pre><p>and</p><pre><code class="nohighlight hljs">@finch for i = :, j = :
    b[] += A[i, j]
end</code></pre><p>becomes</p><pre><code class="nohighlight hljs">@finch for i = :, j = :, s = i:i
    b[] += A[s, j]
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/concordize.jl#L87-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.contain-Tuple{Any, Finch.JuliaContext}-reference-listing" href="#Finch.contain-Tuple{Any, Finch.JuliaContext}-reference-listing"><code>Finch.contain</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">contain(f, ctx)</code></pre><p>Call f on a subcontext of <code>ctx</code> and return the result. Variable bindings, preambles, and epilogues defined in the subcontext will not escape the call to contain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L104-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.countstored-Tuple{Tensor}-reference-listing" href="#Finch.countstored-Tuple{Tensor}-reference-listing"><code>Finch.countstored</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">countstored(arr)</code></pre><p>Return the number of stored elements in <code>arr</code>. If there are explicitly stored fill elements, they are counted too.</p><p>See also: (<code>SparseArrays.nnz</code>)(https://docs.julialang.org/en/v1/stdlib/SparseArrays/#SparseArrays.nnz) and (<code>Base.summarysize</code>)(https://docs.julialang.org/en/v1/base/base/#Base.summarysize)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L254-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.data_rep-Tuple{Any}-reference-listing" href="#Finch.data_rep-Tuple{Any}-reference-listing"><code>Finch.data_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">data_rep(tns)</code></pre><p>Return a trait object representing everything that can be learned about the data based on the storage format (type) of the tensor</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L92-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.dataflow-Tuple{Any}-reference-listing" href="#Finch.dataflow-Tuple{Any}-reference-listing"><code>Finch.dataflow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dataflow(ex)</code></pre><p>Run dead code elimination and constant propagation. <code>ex</code> is the target Julia expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L95-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.declare!-Tuple{Any, Any, Any}-reference-listing" href="#Finch.declare!-Tuple{Any, Any, Any}-reference-listing"><code>Finch.declare!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">declare!(ctx, tns, init)</code></pre><p>Declare the read-only virtual tensor <code>tns</code> in the context <code>ctx</code> with a starting value of <code>init</code> and return it. Afterwards the tensor is update-only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.declare_level!-reference-listing" href="#Finch.declare_level!-reference-listing"><code>Finch.declare_level!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">declare_level!(ctx, lvl, pos, init)</code></pre><p>Initialize and thaw all fibers within <code>lvl</code>, assuming positions <code>1:pos</code> were previously assembled and frozen. The resulting level has no assembled positions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.defer_tables-Tuple{Any, Finch.FinchLogic.LogicNode}-reference-listing" href="#Finch.defer_tables-Tuple{Any, Finch.FinchLogic.LogicNode}-reference-listing"><code>Finch.defer_tables</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">defer_tables(root::LogicNode)</code></pre><p>Replace immediate tensors with deferred expressions assuming the original program structure is given as input to the program.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicExecutor.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.dimensionalize!-Tuple{Any, Any}-reference-listing" href="#Finch.dimensionalize!-Tuple{Any, Any}-reference-listing"><code>Finch.dimensionalize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dimensionalize!(prgm, ctx)</code></pre><p>A program traversal which coordinates dimensions based on shared indices. In particular, loops and declaration statements have dimensions. Accessing a tensor with a raw index <code>hints</code> that the loop should have a dimension corresponding to the tensor axis. Accessing a tensor on the left hand side with a raw index also <code>hints</code> that the tensor declaration should have a dimension corresponding to the loop axis.  All hints inside a loop body are used to evaluate loop dimensions, and all hints after a declaration until the first freeze are used to evaluate declaration dimensions. One may refer to the automatically determined dimension using a variable named <code>_</code> or <code>:</code>. Index sharing is transitive, so <code>A[i] = B[i]</code> and <code>B[j] = C[j]</code> will induce a gathering of the dimensions of <code>A</code>, <code>B</code>, and <code>C</code> into one.</p><p>The dimensions are semantically evaluated just before the corresponding loop or declaration statement.  The program is assumed to be scoped, so that all loops have unique index names.</p><p>See also: <a href="../internals/tensor_interface/#Finch.virtual_size"><code>virtual_size</code></a>, <a href="../internals/tensor_interface/#Finch.virtual_resize!"><code>virtual_resize!</code></a>, <a href="#Finch.combinedim-Tuple{Any, Any, Any}-reference-listing"><code>combinedim</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/dimensionalize.jl#L7-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.dropfills!-Tuple{Finch.AbstractTensor, Any}-reference-listing" href="#Finch.dropfills!-Tuple{Finch.AbstractTensor, Any}-reference-listing"><code>Finch.dropfills!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dropfills!(dst, src)</code></pre><p>Copy only the non- fill values from <code>src</code> into <code>dst</code>. The shape and format of <code>dst</code> must match <code>src</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/copy.jl#L69-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.dropfills-Tuple{Any}-reference-listing" href="#Finch.dropfills-Tuple{Any}-reference-listing"><code>Finch.dropfills</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dropfills(src)</code></pre><p>Drop the fill values from <code>src</code> and return a new tensor with the same shape and format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/copy.jl#L61-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.enforce_lifecycles-Tuple{Any}-reference-listing" href="#Finch.enforce_lifecycles-Tuple{Any}-reference-listing"><code>Finch.enforce_lifecycles</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">enforce_lifecycles(prgm)</code></pre><p>A transformation which adds <code>freeze</code> and <code>thaw</code> statements automatically to tensor roots, depending on whether they appear on the left or right hand side.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/enforce_lifecycles.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.enforce_scopes-Tuple{Any}-reference-listing" href="#Finch.enforce_scopes-Tuple{Any}-reference-listing"><code>Finch.enforce_scopes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">enforce_scopes(prgm)</code></pre><p>A transformation which gives all loops unique index names and enforces that tensor roots are declared in a containing scope and enforces that variables are declared once within their scope. Note that <code>loop</code> and <code>sieve</code> both introduce new scopes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/enforce_scopes.jl#L10-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ensure_concurrent-Tuple{Any, Any}-reference-listing" href="#Finch.ensure_concurrent-Tuple{Any, Any}-reference-listing"><code>Finch.ensure_concurrent</code></a> — <span class="docstring-category">Method</span></header><section><div><p>ensure_concurrent(root, ctx)</p><p>Ensures that all nonlocal assignments to the tensor root are consistently accessed with the same indices and associative operator.  Also ensures that the tensor is either atomic, or accessed by <code>i</code> and concurrent and injective on <code>i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/concurrent.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.evaluate_partial-Tuple{Any, Any}-reference-listing" href="#Finch.evaluate_partial-Tuple{Any, Any}-reference-listing"><code>Finch.evaluate_partial</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">evaluate_partial(ctx, root)</code></pre><p>This pass evaluates tags, global variable definitions, and foldable functions into the context bindings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/evaluate.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.exit_on_yieldbind-Tuple{Any}-reference-listing" href="#Finch.exit_on_yieldbind-Tuple{Any}-reference-listing"><code>Finch.exit_on_yieldbind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">exit_on_yieldbind(prgm)</code></pre><p>This pass rewrites the program so that yieldbind expressions are only present at the end of a block. It also adds a yieldbind if not present already.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/exit_on_yieldbind.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.expanddims-Tuple{Finch.AbstractTensor, Any}-reference-listing" href="#Finch.expanddims-Tuple{Finch.AbstractTensor, Any}-reference-listing"><code>Finch.expanddims</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">expanddims(arr::AbstractTensor, dims)</code></pre><p>Expand the dimensions of an array by inserting a new singleton axis or axes that will appear at the <code>dims</code> position in the expanded array shape.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/eager.jl#L106-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.expanddims_rep-Tuple{Any, Any}-reference-listing" href="#Finch.expanddims_rep-Tuple{Any, Any}-reference-listing"><code>Finch.expanddims_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">expanddims_rep(tns, dims)</code></pre><p>Expand the representation of <code>tns</code> by inserting singleton dimensions <code>dims</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L141-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ffindnz-Tuple{Any}-reference-listing" href="#Finch.ffindnz-Tuple{Any}-reference-listing"><code>Finch.ffindnz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ffindnz(arr)</code></pre><p>Return the nonzero elements of <code>arr</code>, as Finch understands <code>arr</code>. Returns <code>(I..., V)</code>, where <code>I</code> are the coordinate vectors, one for each mode of <code>arr</code>, and <code>V</code> is a vector of corresponding nonzero values, which can be passed to <a href="../../guides/sparse_utils/#Finch.fsparse"><code>fsparse</code></a>.</p><p>See also: (<code>findnz</code>)(https://docs.julialang.org/en/v1/stdlib/SparseArrays/#SparseArrays.findnz)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fsparse.jl#L248-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fiber_ctr-reference-listing" href="#Finch.fiber_ctr-reference-listing"><code>Finch.fiber_ctr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fiber_ctr(tns, protos...)</code></pre><p>Return an expression that would construct a tensor suitable to hold data with a representation described by <code>tns</code>. Assumes representation is collapsed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L412-L417">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fill_value-reference-listing" href="#Finch.fill_value-reference-listing"><code>Finch.fill_value</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fill_value(arr)</code></pre><p>Return the initializer for <code>arr</code>. For SparseArrays, this is 0. Often, the &quot;fill&quot; value becomes the &quot;background&quot; value of a tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L49-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.filterop-Tuple{Any}-reference-listing" href="#Finch.filterop-Tuple{Any}-reference-listing"><code>Finch.filterop</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">filterop(z)(cond, arg)</code></pre><p><code>filterop(z)</code> is a function which returns <code>ifelse(cond, arg, z)</code>. This operation is handy for filtering out values based on a mask or a predicate. <code>map(filterop(0), cond, arg)</code> is analogous to <code>filter(x -&gt; cond ? x: z, arg)</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; a = Tensor(SparseList(Element(0.0)), [0, 1.1, 0, 4.4, 0])
5-Tensor
└─ SparseList (0.0) [1:5]
   ├─ [2]: 1.1
   └─ [4]: 4.4

julia&gt; x = Tensor(SparseList(Element(0.0)));

julia&gt; c = Tensor(SparseList(Element(false)), [false, false, false, true, false]);

julia&gt; @finch (x .= 0; for i=_; x[i] = filterop(0)(c[i], a[i]) end)
(x = Tensor(SparseList{Int64}(Element{0.0, Float64, Int64}([4.4]), 5, [1, 2], [4])),)

julia&gt; x
5-Tensor
└─ SparseList (0.0) [1:5]
   └─ [4]: 4.4</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L38-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.finch_kernel-Tuple{Any, Any, Any}-reference-listing" href="#Finch.finch_kernel-Tuple{Any, Any, Any}-reference-listing"><code>Finch.finch_kernel</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">finch_kernel(fname, args, prgm; options...)</code></pre><p>Return a function definition for which can execute a Finch program of type <code>prgm</code>. Here, <code>fname</code> is the name of the function and <code>args</code> is a <code>iterable</code> of argument name =&gt; type pairs.</p><p>See also: <a href="../../guides/calling_finch/#Finch.@finch"><code>@finch</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/execute.jl#L221-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fld1_nothrow-Tuple{Any, Any}-reference-listing" href="#Finch.fld1_nothrow-Tuple{Any, Any}-reference-listing"><code>Finch.fld1_nothrow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fld1_nothrow(x, y)</code></pre><p>Returns <code>fld1(x, y)</code> normally, returns one and issues a warning if <code>y</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L127-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fld_nothrow-Tuple{Any, Any}-reference-listing" href="#Finch.fld_nothrow-Tuple{Any, Any}-reference-listing"><code>Finch.fld_nothrow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fld_nothrow(x, y)</code></pre><p>Returns <code>fld(x, y)</code> normally, returns zero and issues a warning if <code>y</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fread-Tuple{AbstractString}-reference-listing" href="#Finch.fread-Tuple{AbstractString}-reference-listing"><code>Finch.fread</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fread(filename::AbstractString)</code></pre><p>Read the Finch tensor from a file using a file format determined by the file extension. The following file extensions are supported:</p><ul><li><code>.bsp.h5</code>: <a href="https://github.com/GraphBLAS/binsparse-specification">Binsparse</a> HDF5 file format</li><li><code>.bspnpy</code>: <a href="https://github.com/GraphBLAS/binsparse-specification">Binsparse</a> NumPy and JSON subdirectory format</li><li><code>.mtx</code>: <a href="https://math.nist.gov/MatrixMarket/formats.html#MMformat">MatrixMarket</a> <code>.mtx</code> text file format</li><li><code>.ttx</code>: <a href="https://github.com/willow-ahrens/TensorMarket.jl">TensorMarket</a> <code>.ttx</code> text file format</li><li><code>.tns</code>: <a href="http://frostt.io/tensors/">FROSTT</a> <code>.tns</code> text file format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/fileio.jl#L25-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.freeze!-reference-listing" href="#Finch.freeze!-reference-listing"><code>Finch.freeze!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">freeze!(ctx, tns)</code></pre><p>Freeze the update-only virtual tensor <code>tns</code> in the context <code>ctx</code> and return it. This may involve trimming any excess overallocated memory.  Afterwards, the tensor is read-only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L32-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.freeze_level!-Tuple{Any, Any, Any}-reference-listing" href="#Finch.freeze_level!-Tuple{Any, Any, Any}-reference-listing"><code>Finch.freeze_level!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">freeze_level!(ctx, lvl, pos)</code></pre><p>Freeze all fibers in <code>lvl</code>. Positions <code>1:pos</code> need freezing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.freeze_level!-reference-listing" href="#Finch.freeze_level!-reference-listing"><code>Finch.freeze_level!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">freeze_level!(ctx, lvl, pos, init)</code></pre><p>Given the last reference position, <code>pos</code>, freeze all fibers within <code>lvl</code> assuming that we have potentially updated <code>1:pos</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L68-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.freshen-Tuple{Finch.Namespace, Vararg{Any}}-reference-listing" href="#Finch.freshen-Tuple{Finch.Namespace, Vararg{Any}}-reference-listing"><code>Finch.freshen</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">freshen(ctx, tags...)</code></pre><p>Return a fresh variable in the current context named after <code>Symbol(tags...)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fsparse!-Tuple-reference-listing" href="#Finch.fsparse!-Tuple-reference-listing"><code>Finch.fsparse!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fsparse!(I..., V,[ M::Tuple])</code></pre><p>Like <a href="../../guides/sparse_utils/#Finch.fsparse"><code>fsparse</code></a>, but the coordinates must be sorted and unique, and memory is reused.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fsparse.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fsparse-Tuple{AbstractVector, Vararg{Any}}-reference-listing" href="#Finch.fsparse-Tuple{AbstractVector, Vararg{Any}}-reference-listing"><code>Finch.fsparse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fsparse(I::Tuple, V,[ M::Tuple, combine]; fill_value=zero(eltype(V)))</code></pre><p>Create a sparse COO tensor <code>S</code> such that <code>size(S) == M</code> and <code>S[(i[q] for i = I)...] = V[q]</code>. The combine function is used to combine duplicates. If <code>M</code> is not specified, it is set to <code>map(maximum, I)</code>. If the combine function is not supplied, combine defaults to <code>+</code> unless the elements of V are Booleans in which case combine defaults to <code>|</code>. All elements of I must satisfy 1 &lt;= I[n][q] &lt;= M[n].  Numerical zeros are retained as structural nonzeros; to drop numerical zeros, use dropzeros!.</p><p>See also: <a href="https://docs.julialang.org/en/v1/stdlib/SparseArrays/#SparseArrays.sparse"><code>sparse</code></a></p><p><strong>Examples</strong></p><p>julia&gt; I = (     [1, 2, 3],     [1, 2, 3],     [1, 2, 3]);</p><p>julia&gt; V = [1.0; 2.0; 3.0];</p><p>julia&gt; fsparse(I, V) SparseCOO (0.0) [1:3×1:3×1:3] │ │ │ └─└─└─[1, 1, 1] [2, 2, 2] [3, 3, 3]       1.0       2.0       3.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fsparse.jl#L1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fsprand-Tuple-reference-listing" href="#Finch.fsprand-Tuple-reference-listing"><code>Finch.fsprand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fsprand([rng],[type], M..., p, [rfn])</code></pre><p>Create a random sparse tensor of size <code>m</code> in COO format. There are two cases:     - If <code>p</code> is floating point, the probability of any element being nonzero is     independently given by <code>p</code> (and hence the expected density of nonzeros is     also <code>p</code>).     - If <code>p</code> is an integer, exactly <code>p</code> nonzeros are distributed uniformly at     random throughout the tensor (and hence the density of nonzeros is exactly     <code>p / prod(M)</code>). Nonzero values are sampled from the distribution specified by <code>rfn</code> and have the type <code>type</code>. The uniform distribution is used in case <code>rfn</code> is not specified. The optional <code>rng</code> argument specifies a random number generator.</p><p>See also: (<code>sprand</code>)(https://docs.julialang.org/en/v1/stdlib/SparseArrays/#SparseArrays.sprand)</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; fsprand(Bool, 3, 3, 0.5)
SparseCOO (false) [1:3,1:3]
├─├─[1, 1]: true
├─├─[3, 1]: true
├─├─[2, 2]: true
├─├─[3, 2]: true
├─├─[3, 3]: true

julia&gt; fsprand(Float64, 2, 2, 2, 0.5)
SparseCOO (0.0) [1:2,1:2,1:2]
├─├─├─[2, 2, 1]: 0.6478553157718558
├─├─├─[1, 1, 2]: 0.996665291437684
├─├─├─[2, 1, 2]: 0.7491940599574348</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fsparse.jl#L74-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fspzeros-Tuple-reference-listing" href="#Finch.fspzeros-Tuple-reference-listing"><code>Finch.fspzeros</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fspzeros([type], M...)</code></pre><p>Create a random zero tensor of size <code>M</code>, with elements of type <code>type</code>. The tensor is in COO format.</p><p>See also: (<code>spzeros</code>)(https://docs.julialang.org/en/v1/stdlib/SparseArrays/#SparseArrays.spzeros)</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fspzeros(Bool, 3, 3)
3×3-Tensor
└─ SparseCOO{2} (false) [:,1:3]

julia&gt; fspzeros(Float64, 2, 2, 2)
2×2×2-Tensor
└─ SparseCOO{3} (0.0) [:,:,1:2]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fsparse.jl#L224-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ftnsread-Tuple-reference-listing" href="#Finch.ftnsread-Tuple-reference-listing"><code>Finch.ftnsread</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ftnsread(filename)</code></pre><p>Read the contents of the FROSTT <code>.tns</code> file &#39;filename&#39; into a Finch COO Tensor.</p><p><a href="https://github.com/willow-ahrens/TensorMarket.jl">TensorMarket</a> must be loaded for this function to be available.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>This file format does not record the size or eltype of the tensor, and is provided for archival purposes only.</p></div></div><p>See also: <a href="http://willowahrens.io/TensorMarket.jl/stable/#TensorMarket.tnsread">tnsread</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/tensormarket.jl#L39-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.ftnswrite-Tuple-reference-listing" href="#Finch.ftnswrite-Tuple-reference-listing"><code>Finch.ftnswrite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ftnswrite(filename, tns)</code></pre><p>Write a sparse Finch tensor to a FROSTT <code>.tns</code> file.</p><p><a href="https://github.com/willow-ahrens/TensorMarket.jl">TensorMarket</a> must be loaded for this function to be available.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>This file format does not record the size or eltype of the tensor, and is provided for archival purposes only.</p></div></div><p>See also: <a href="http://willowahrens.io/TensorMarket.jl/stable/#TensorMarket.tnswrite">tnswrite</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/tensormarket.jl#L24-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fttread-Tuple-reference-listing" href="#Finch.fttread-Tuple-reference-listing"><code>Finch.fttread</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fttread(filename, infoonly=false, retcoord=false)</code></pre><p>Read the TensorMarket file into a Finch tensor. The tensor will be dense or COO depending on the format of the file.</p><p><a href="https://github.com/willow-ahrens/TensorMarket.jl">TensorMarket</a> must be loaded for this function to be available.</p><p>See also: <a href="http://willowahrens.io/TensorMarket.jl/stable/#TensorMarket.ttread">ttread</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/tensormarket.jl#L12-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fttwrite-Tuple-reference-listing" href="#Finch.fttwrite-Tuple-reference-listing"><code>Finch.fttwrite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fttwrite(filename, tns)</code></pre><p>Write a sparse Finch tensor to a TensorMarket file.</p><p><a href="https://github.com/willow-ahrens/TensorMarket.jl">TensorMarket</a> must be loaded for this function to be available.</p><p>See also: <a href="http://willowahrens.io/TensorMarket.jl/stable/#TensorMarket.ttwrite">ttwrite</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/tensormarket.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fused-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.fused-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.fused</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fused(f, args...; kwargs...)</code></pre><p>This function decorator modifies <code>f</code> to fuse the contained array operations and optimize the resulting program. The function must return a single array or tuple of arrays. <code>kwargs</code> are passed to <a href="../../guides/array_api/#Finch.compute"><code>compute</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/lazy.jl#L444-L450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.fwrite-Tuple{AbstractString, Any}-reference-listing" href="#Finch.fwrite-Tuple{AbstractString, Any}-reference-listing"><code>Finch.fwrite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fwrite(filename::AbstractString, tns::Finch.Tensor)</code></pre><p>Write the Finch tensor to a file using a file format determined by the file extension. The following file extensions are supported:</p><ul><li><code>.bsp.h5</code>: <a href="https://github.com/GraphBLAS/binsparse-specification">Binsparse</a> HDF5 file format</li><li><code>.bspnpy</code>: <a href="https://github.com/GraphBLAS/binsparse-specification">Binsparse</a> NumPy and JSON subdirectory format</li><li><code>.mtx</code>: <a href="https://math.nist.gov/MatrixMarket/formats.html#MMformat">MatrixMarket</a> <code>.mtx</code> text file format</li><li><code>.ttx</code>: <a href="https://github.com/willow-ahrens/TensorMarket.jl">TensorMarket</a> <code>.ttx</code> text file format</li><li><code>.tns</code>: <a href="http://frostt.io/tensors/">FROSTT</a> <code>.tns</code> text file format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/fileio/fileio.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_algebra-Tuple{Finch.SymbolicContext}-reference-listing" href="#Finch.get_algebra-Tuple{Finch.SymbolicContext}-reference-listing"><code>Finch.get_algebra</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_algebra(ctx)</code></pre><p>get the algebra used in the current context</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L252-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_binding!-Tuple{Finch.AbstractCompiler, Any, Any}-reference-listing" href="#Finch.get_binding!-Tuple{Finch.AbstractCompiler, Any, Any}-reference-listing"><code>Finch.get_binding!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_binding!(ctx, var, val)</code></pre><p>Get the binding of a variable in the context, or set it to a default value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_binding-Tuple{Finch.AbstractCompiler, Any, Any}-reference-listing" href="#Finch.get_binding-Tuple{Finch.AbstractCompiler, Any, Any}-reference-listing"><code>Finch.get_binding</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_binding(ctx, var, val)</code></pre><p>Get the binding of a variable in the context, or return a default value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_binding-Tuple{Finch.ScopeContext, Any}-reference-listing" href="#Finch.get_binding-Tuple{Finch.ScopeContext, Any}-reference-listing"><code>Finch.get_binding</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_binding(ctx, var)</code></pre><p>Get the binding of a variable in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_lock-Tuple{Finch.AbstractDevice, Any, Any, Any}-reference-listing" href="#Finch.get_lock-Tuple{Finch.AbstractDevice, Any, Any, Any}-reference-listing"><code>Finch.get_lock</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_lock(dev::AbstractDevice, arr, idx, ty)</code></pre><p>Given a device, an array of elements of type ty, and an index to the array, idx, gets a lock of type ty associated to arr[idx] on dev.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/architecture.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_mode_flag-Tuple{Finch.FinchCompiler}-reference-listing" href="#Finch.get_mode_flag-Tuple{Finch.FinchCompiler}-reference-listing"><code>Finch.get_mode_flag</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_mode_flag(ctx)</code></pre><p>Return the mode flag given in <code>@finch mode = ?</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/lower.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_prove_rules-Tuple{Any, Any}-reference-listing" href="#Finch.get_prove_rules-Tuple{Any, Any}-reference-listing"><code>Finch.get_prove_rules</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_prove_rules(alg, shash)</code></pre><p>Return the bound rule set for Finch. One can dispatch on the <code>alg</code> trait to specialize the rule set for different algebras. <code>shash</code> is an object that can be called to return a static hash value. This rule set is used to analyze loop bounds in Finch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/prove.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_result-Tuple{Finch.FinchCompiler}-reference-listing" href="#Finch.get_result-Tuple{Finch.FinchCompiler}-reference-listing"><code>Finch.get_result</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_result(ctx)</code></pre><p>Return a variable which evaluates to the result of the program which should be returned to the user.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/lower.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_scheduler-Tuple{}-reference-listing" href="#Finch.get_scheduler-Tuple{}-reference-listing"><code>Finch.get_scheduler</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_scheduler()</code></pre><p>Get the current Finch scheduler used by <code>compute</code> to execute lazy tensor programs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/lazy.jl#L465-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_simplify_rules-Tuple{Any, Any}-reference-listing" href="#Finch.get_simplify_rules-Tuple{Any, Any}-reference-listing"><code>Finch.get_simplify_rules</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_simplify_rules(alg, shash)</code></pre><p>Return the program rule set for Finch. One can dispatch on the <code>alg</code> trait to specialize the rule set for different algebras. Defaults to a collection of straightforward rules that use the algebra to check properties of functions like associativity, commutativity, etc. <code>shash</code> is an object that can be called to return a static hash value. This rule set simplifies, normalizes, and propagates constants, and is the basis for how Finch understands sparsity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/simplify.jl#L28-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_static_hash-Tuple{Finch.SymbolicContext}-reference-listing" href="#Finch.get_static_hash-Tuple{Finch.SymbolicContext}-reference-listing"><code>Finch.get_static_hash</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_static_hash(ctx)</code></pre><p>Return an object which can be called as a hash function. The hashes are the same when objects are hashed in the same order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L259-L264">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_structure-reference-listing" href="#Finch.get_structure-reference-listing"><code>Finch.get_structure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_structure(root::LogicNode)</code></pre><p>Quickly produce a normalized structure for a logic program. Note: the result will not be a runnable logic program, but can be hashed and compared for equality. Two programs will have equal structure if their tensors have the same type and their program structure is equivalent up to renaming.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/LogicCompiler.jl#L9-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_style-Tuple{Any, Any}-reference-listing" href="#Finch.get_style-Tuple{Any, Any}-reference-listing"><code>Finch.get_style</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_style(ctx, root)</code></pre><p>return the style to use for lowering <code>root</code> in <code>ctx</code>. This method is used to determine which pass should be used to lower a given node. The default implementation returns <code>DefaultStyle()</code>. Overload the three argument form of this method, <code>get_style(ctx, node, root)</code> and specialize on <code>node</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/lower.jl#L87-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_task-Tuple{Any}-reference-listing" href="#Finch.get_task-Tuple{Any}-reference-listing"><code>Finch.get_task</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_task(ctx)</code></pre><p>Get the task which will execute code in this context</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_tensor_mode-Tuple{Finch.ScopeContext, Any}-reference-listing" href="#Finch.get_tensor_mode-Tuple{Finch.ScopeContext, Any}-reference-listing"><code>Finch.get_tensor_mode</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_tensor_mode(ctx, var)</code></pre><p>Get the mode of a tensor variable in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.get_wrapper_rules-Tuple{Any, Any, Any}-reference-listing" href="#Finch.get_wrapper_rules-Tuple{Any, Any, Any}-reference-listing"><code>Finch.get_wrapper_rules</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_wrapper_rules(ctx, depth, alg)</code></pre><p>Return the wrapperizing rule set for Finch, which converts expressions like `A[i</p><ul><li>1]<code>to array combinator expressions like</code>OffsetArray(A, (1,))`. The rules have</li></ul><p>access to the algebra <code>alg</code> and the depth lookup <code>depth</code><code>One can dispatch on the</code>alg` trait to specialize the rule set for different algebras. These rules run after simplification so one can expect constants to be folded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/wrapperize.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.getindex_rep-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.getindex_rep-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.getindex_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">getindex_rep(tns, idxs...)</code></pre><p>Return a trait object representing the result of calling getindex(tns, idxs...) on the tensor represented by <code>tns</code>. Assumes traits are in collapsed form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/index.jl#L9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.getunbound-Tuple{Any}-reference-listing" href="#Finch.getunbound-Tuple{Any}-reference-listing"><code>Finch.getunbound</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">getunbound(stmt)</code></pre><p>Return an iterator over the indices in a Finch program that have yet to be bound.</p><pre><code class="language-julia hljs">julia&gt; getunbound(@finch_program for i=_; :a[i, j] += 2 end)
[j]
julia&gt; getunbound(@finch_program i + j * 2 * i)
[i, j]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/simplify.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.has_binding-Tuple{Finch.ScopeContext, Any}-reference-listing" href="#Finch.has_binding-Tuple{Finch.ScopeContext, Any}-reference-listing"><code>Finch.has_binding</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">has_binding(ctx, var)</code></pre><p>Check if a variable is bound in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.instantiate!-Tuple{Any, Any}-reference-listing" href="#Finch.instantiate!-Tuple{Any, Any}-reference-listing"><code>Finch.instantiate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">instantiate!(ctx, prgm)</code></pre><p>A transformation to instantiate readers and updaters before executing an expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/execute.jl#L13-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.instantiate-Tuple{Any, Any, Any, Any, Vararg{Any}}-reference-listing" href="#Finch.instantiate-Tuple{Any, Any, Any, Any, Vararg{Any}}-reference-listing"><code>Finch.instantiate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">instantiate(ctx, tns, mode, protos)</code></pre><p>Return an object (usually a looplet nest) capable of unfurling the virtual tensor <code>tns</code>. Before executing a statement, each subsequent in-scope access will be initialized with a separate call to <code>instantiate</code>. <code>protos</code> is the list of protocols in each case.</p><p>The fallback for <code>instantiate</code> will iteratively move the last element of <code>protos</code> into the arguments of a function. This allows fibers to specialize on the last arguments of protos rather than the first, as Finch is column major.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L12-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.is_atomic-reference-listing" href="#Finch.is_atomic-reference-listing"><code>Finch.is_atomic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_atomic(ctx, tns)

Returns a tuple (atomicities, overall) where atomicities is a vector, indicating which indices have an atomic that guards them,
and overall is a boolean that indicates is the last level had an atomic guarding it.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/concurrent.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.is_concurrent-reference-listing" href="#Finch.is_concurrent-reference-listing"><code>Finch.is_concurrent</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_concurrent(ctx, tns)

Returns a vector of booleans, one for each dimension of the tensor, indicating
whether the index can be written to without any execution state. So if a matrix returns [true, false],
then we can write to A[i, j] and A[i_2, j] without any shared execution state between the two, but
we can&#39;t write to A[i, j] and A[i, j_2] without carrying over execution state.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/concurrent.jl#L23-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.is_injective-reference-listing" href="#Finch.is_injective-reference-listing"><code>Finch.is_injective</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_injective(ctx, tns)</code></pre><p>Returns a vector of booleans, one for each dimension of the tensor, indicating whether the access is injective in that dimension.  A dimension is injective if each index in that dimension maps to a different memory space in the underlying array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/concurrent.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isannihilator-Tuple{Any, Any, Any}-reference-listing" href="#Finch.isannihilator-Tuple{Any, Any, Any}-reference-listing"><code>Finch.isannihilator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isannihilator(algebra, f, x)</code></pre><p>Return true when <code>f(a..., x, b...) = x</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L115-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isassociative-Tuple{Any, Any}-reference-listing" href="#Finch.isassociative-Tuple{Any, Any}-reference-listing"><code>Finch.isassociative</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isassociative(algebra, f)</code></pre><p>Return true when <code>f(a..., f(b...), c...) = f(a..., b..., c...)</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.iscommutative-Tuple{Any, Any}-reference-listing" href="#Finch.iscommutative-Tuple{Any, Any}-reference-listing"><code>Finch.iscommutative</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">iscommutative(algebra, f)</code></pre><p>Return true when for all permutations p, <code>f(a...) = f(a[p]...)</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isdistributive-Tuple{Any, Any, Any}-reference-listing" href="#Finch.isdistributive-Tuple{Any, Any, Any}-reference-listing"><code>Finch.isdistributive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isdistributive(algebra, f, g)</code></pre><p>Return true when <code>f(a, g(b, c)) = g(f(a, b), f(a, c))</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L49-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isidempotent-Tuple{Any, Any}-reference-listing" href="#Finch.isidempotent-Tuple{Any, Any}-reference-listing"><code>Finch.isidempotent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isidempotent(algebra, f)</code></pre><p>Return true when <code>f(a, b) = f(f(a, b), b)</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isidentity-Tuple{Any}-reference-listing" href="#Finch.isidentity-Tuple{Any}-reference-listing"><code>Finch.isidentity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isidentity(algebra, f, x)</code></pre><p>Return true when <code>f(a..., x, b...) = f(a..., b...)</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isinverse-Tuple{Any, Any, Any}-reference-listing" href="#Finch.isinverse-Tuple{Any, Any, Any}-reference-listing"><code>Finch.isinverse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isinverse(algebra, f, g)</code></pre><p>Return true when <code>f(a, g(a))</code> is the identity under <code>f</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L150-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.isinvolution-Tuple{Any, Any}-reference-listing" href="#Finch.isinvolution-Tuple{Any, Any}-reference-listing"><code>Finch.isinvolution</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isinvolution(algebra, f)</code></pre><p>Return true when <code>f(f(a)) = a</code> in <code>algebra</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L161-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.labelled_children-Tuple{Any}-reference-listing" href="#Finch.labelled_children-Tuple{Any}-reference-listing"><code>Finch.labelled_children</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">labelled_children(node)</code></pre><p>Return the children of <code>node</code> in a <code>LabelledTree</code>. You may label the children by returning a <code>LabelledTree(key, value)</code>, which will be shown as <code>key: value</code> a.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L138-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.labelled_show-Tuple{Any, Any}-reference-listing" href="#Finch.labelled_show-Tuple{Any, Any}-reference-listing"><code>Finch.labelled_show</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">labelled_show(node)</code></pre><p>Show the <code>node</code> in a <code>LabelledTree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L130-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.lazy-Tuple{Any}-reference-listing" href="#Finch.lazy-Tuple{Any}-reference-listing"><code>Finch.lazy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lazy(arg)</code></pre><p>Create a lazy tensor from an argument. All operations on lazy tensors are lazy, and will not be executed until <code>compute</code> is called on their result.</p><p>for example,</p><pre><code class="language-julia hljs">x = lazy(rand(10))
y = lazy(rand(10))
z = x + y
z = z + 1
z = compute(z)</code></pre><p>will not actually compute <code>z</code> until <code>compute(z)</code> is called, so the execution of <code>x + y</code> is fused with the execution of <code>z + 1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/lazy.jl#L423-L439">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.level_axes-reference-listing" href="#Finch.level_axes-reference-listing"><code>Finch.level_axes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">level_axes(lvl)</code></pre><p>The result of <code>level_axes(lvl)</code> defines the <a href="https://docs.julialang.org/en/v1/base/arrays/#Base.axes-Tuple{Any}">axes</a> of all subfibers in the level <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L35-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.level_eltype-reference-listing" href="#Finch.level_eltype-reference-listing"><code>Finch.level_eltype</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">level_eltype(::Type{Lvl})</code></pre><p>The result of <code>level_eltype(Lvl)</code> defines <a href="https://docs.julialang.org/en/v1/base/collections/#Base.eltype"><code>eltype</code></a> for all subfibers in a level of type <code>Lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.level_fill_value-reference-listing" href="#Finch.level_fill_value-reference-listing"><code>Finch.level_fill_value</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">level_fill_value(::Type{Lvl})</code></pre><p>The result of <code>level_fill_value(Lvl)</code> defines <a href="../internals/tensor_interface/#Finch.fill_value"><code>fill_value</code></a> for all subfibers in a level of type <code>Lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L52-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.level_ndims-reference-listing" href="#Finch.level_ndims-reference-listing"><code>Finch.level_ndims</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">level_ndims(::Type{Lvl})</code></pre><p>The result of <code>level_ndims(Lvl)</code> defines <a href="https://docs.julialang.org/en/v1/base/arrays/#Base.ndims">ndims</a> for all subfibers in a level of type <code>Lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.level_size-reference-listing" href="#Finch.level_size-reference-listing"><code>Finch.level_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">level_size(lvl)</code></pre><p>The result of <code>level_size(lvl)</code> defines the <a href="https://docs.julialang.org/en/v1/base/arrays/#Base.size">size</a> of all subfibers in the level <code>lvl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L27-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.lift_fields-Tuple{Any}-reference-listing" href="#Finch.lift_fields-Tuple{Any}-reference-listing"><code>Finch.lift_fields</code></a> — <span class="docstring-category">Method</span></header><section><div><p>This one is a placeholder that places reorder statements inside aggregate and mapjoin query nodes. only works on the output of propagate<em>fields(push</em>fields(prgm))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L215-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.lift_subqueries-Tuple{Finch.FinchLogic.LogicNode}-reference-listing" href="#Finch.lift_subqueries-Tuple{Finch.FinchLogic.LogicNode}-reference-listing"><code>Finch.lift_subqueries</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lift_subqueries</code></pre><p>Creates a plan that lifts all subqueries to the top level of the program, with unique queries for each distinct subquery alias. This function processes the rhs of each subquery once, to carefully extract SSA form from any nested pointer structure. After calling lift_subqueries, it is safe to map over the program (recursive pointers to subquery structures will not incur exponential overhead).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L42-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.lower_global-Tuple{Any, Any}-reference-listing" href="#Finch.lower_global-Tuple{Any, Any}-reference-listing"><code>Finch.lower_global</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lower_global(ctx, prgm)</code></pre><p>lower the program <code>prgm</code> at global scope in the context <code>ctx</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/execute.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.make_lock-reference-listing" href="#Finch.make_lock-reference-listing"><code>Finch.make_lock</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_lock(ty)</code></pre><p>Makes a lock of type ty.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/architecture.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.map_rep-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.map_rep-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.map_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">map_rep(f, args...)</code></pre><p>Return a storage trait object representing the result of mapping <code>f</code> over storage traits <code>args</code>. Assumes representation is collapsed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L129-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.materialize_squeeze_expand_productions-Tuple{Any}-reference-listing" href="#Finch.materialize_squeeze_expand_productions-Tuple{Any}-reference-listing"><code>Finch.materialize_squeeze_expand_productions</code></a> — <span class="docstring-category">Method</span></header><section><div><p>materialize<em>squeeze</em>expand_productions(root)</p><p>Makes separate kernels for squeeze and expand operations in produces statements, since swizzle does not support this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L173-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.maxby-Tuple{Any, Any}-reference-listing" href="#Finch.maxby-Tuple{Any, Any}-reference-listing"><code>Finch.maxby</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">maxby(a, b)</code></pre><p>Return the max of <code>a</code> or <code>b</code>, comparing them by <code>a[1]</code> and <code>b[1]</code>, and breaking ties to the left. Useful for implementing argmax operations:</p><pre><code class="language-julia-repl hljs">julia&gt; a = [7.7, 3.3, 9.9, 3.3, 9.9]; x = Scalar(-Inf =&gt; 0);

julia&gt; @finch for i=_; x[] &lt;&lt;maxby&gt;&gt;= a[i] =&gt; i end;

julia&gt; x[]
9.9 =&gt; 3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L83-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.minby-Tuple{Any, Any}-reference-listing" href="#Finch.minby-Tuple{Any, Any}-reference-listing"><code>Finch.minby</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">minby(a, b)</code></pre><p>Return the min of <code>a</code> or <code>b</code>, comparing them by <code>a[1]</code> and <code>b[1]</code>, and breaking ties to the left. Useful for implementing argmin operations:</p><pre><code class="language-julia-repl hljs">julia&gt; a = [7.7, 3.3, 9.9, 3.3, 9.9]; x = Scalar(Inf =&gt; 0);

julia&gt; @finch for i=_; x[] &lt;&lt;minby&gt;&gt;= a[i] =&gt; i end;

julia&gt; x[]
3.3 =&gt; 2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L67-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.mod1_nothrow-Tuple{Any, Any}-reference-listing" href="#Finch.mod1_nothrow-Tuple{Any, Any}-reference-listing"><code>Finch.mod1_nothrow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mod1_nothrow(x, y)</code></pre><p>Returns <code>mod1(x, y)</code> normally, returns one and issues a warning if <code>y</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L113-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.mod_nothrow-Tuple{Any, Any}-reference-listing" href="#Finch.mod_nothrow-Tuple{Any, Any}-reference-listing"><code>Finch.mod_nothrow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mod_nothrow(x, y)</code></pre><p>Returns <code>mod(x, y)</code> normally, returns zero and issues a warning if <code>y</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.moveto-reference-listing" href="#Finch.moveto-reference-listing"><code>Finch.moveto</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">moveto(arr, device)</code></pre><p>If the array is not on the given device, it creates a new version of this array on that device and copies the data in to it, according to the <code>device</code> trait.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L99-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.offset-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.offset-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.offset</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">offset(tns, delta...)</code></pre><p>Create an <code>OffsetArray</code> such that <code>offset(tns, delta...)[i...] == tns[i .+ delta...]</code>. The dimensions declared by an OffsetArray are shifted, so that <code>size(offset(tns, delta...)) == size(tns) .+ delta</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/offset.jl#L35-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.open_scope-Union{Tuple{F}, Tuple{F, Finch.ScopeContext}} where F-reference-listing" href="#Finch.open_scope-Union{Tuple{F}, Tuple{F, Finch.ScopeContext}} where F-reference-listing"><code>Finch.open_scope</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">open_scope(f, ctx)</code></pre><p>Call the function <code>f(ctx_2)</code> in a new scope <code>ctx_2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.pattern!-Tuple{Tensor}-reference-listing" href="#Finch.pattern!-Tuple{Tensor}-reference-listing"><code>Finch.pattern!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pattern!(fbr)</code></pre><p>Return the pattern of <code>fbr</code>. That is, return a tensor which is true wherever <code>fbr</code> is structurally unequal to its fill_value. May reuse memory and render the original tensor unusable when modified.</p><pre><code class="language-julia-repl hljs">julia&gt; A = Tensor(SparseList(Element(0.0), 10), [2.0, 0.0, 3.0, 0.0, 4.0, 0.0, 5.0, 0.0, 6.0, 0.0])
10-Tensor
└─ SparseList (0.0) [1:10]
   ├─ [1]: 2.0
   ├─ [3]: 3.0
   ├─ ⋮
   ├─ [7]: 5.0
   └─ [9]: 6.0

julia&gt; pattern!(A)
10-Tensor
└─ SparseList (false) [1:10]
   ├─ [1]: true
   ├─ [3]: true
   ├─ ⋮
   ├─ [7]: true
   └─ [9]: true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/levels/pattern_levels.jl#L53-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.permissive-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.permissive-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.permissive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">permissive(tns, dims...)</code></pre><p>Create an <code>PermissiveArray</code> where <code>permissive(tns, dims...)[i...]</code> is <code>missing</code> if <code>i[n]</code> is not in the bounds of <code>tns</code> when <code>dims[n]</code> is <code>true</code>.  This wrapper allows all permissive dimensions to be exempt from dimension checks, and is useful when we need to access an array out of bounds, or for padding. More formally,</p><pre><code class="nohighlight hljs">    permissive(tns, dims...)[i...] =
        if any(n -&gt; dims[n] &amp;&amp; !(i[n] in axes(tns)[n]))
            missing
        else
            tns[i...]
        end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/permissive.jl#L36-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.permutedims_rep-Tuple{Any, Any}-reference-listing" href="#Finch.permutedims_rep-Tuple{Any, Any}-reference-listing"><code>Finch.permutedims_rep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">permutedims_rep(tns, perm)</code></pre><p>Return a trait object representing the result of permuting a tensor represented by <code>tns</code> to the permutation <code>perm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L324-L329">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.postype-reference-listing" href="#Finch.postype-reference-listing"><code>Finch.postype</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">postype(lvl)</code></pre><p>Return a position type with the same flavor as those used to store the positions of the fibers contained in <code>lvl</code>. The name position descends from the pos or position or pointer arrays found in many definitions of CSR or CSC. In Finch, positions should be data used to access either a subfiber or some other similar auxiliary data. Thus, we often end up iterating over positions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L109-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.pretty-Tuple{Any}-reference-listing" href="#Finch.pretty-Tuple{Any}-reference-listing"><code>Finch.pretty</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pretty(ex)</code></pre><p>Make ex prettier. Shorthand for <code>ex |&gt; unblock |&gt; striplines |&gt; regensym</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.products-Tuple{Any, Any}-reference-listing" href="#Finch.products-Tuple{Any, Any}-reference-listing"><code>Finch.products</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">products(tns, dim)</code></pre><p>Create a <code>ProductArray</code> such that</p><pre><code class="nohighlight hljs">    products(tns, dim)[i...] == tns[i[1:dim-1]..., i[dim] * i[dim + 1], i[dim + 2:end]...]</code></pre><p>This is like <a href="../../guides/index_sugar/#Finch.toeplitz"><code>toeplitz</code></a> but with times instead of plus.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/product.jl#L53-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.propagate_transpose_queries-reference-listing" href="#Finch.propagate_transpose_queries-reference-listing"><code>Finch.propagate_transpose_queries</code></a> — <span class="docstring-category">Function</span></header><section><div><p>propagate<em>transpose</em>queries(root)</p><p>Removes non-materializing permutation queries by propagating them to the expressions they contain. Pushes fields and also removes copies. Removes queries of the form:</p><pre><code class="nohighlight hljs">    query(ALIAS, reorder(relabel(ALIAS, FIELD...), FIELD...))</code></pre><p>Does not remove queries which define production aliases.</p><p>Accepts programs of the form:</p><pre><code class="nohighlight hljs">       TABLE  := table(IMMEDIATE, FIELD...)
       ACCESS := reorder(relabel(ALIAS, FIELD...), FIELD...)
    POINTWISE := ACCESS | mapjoin(IMMEDIATE, POINTWISE...) | reorder(IMMEDIATE, FIELD...) | IMMEDIATE
    MAPREDUCE := POINTWISE | aggregate(IMMEDIATE, IMMEDIATE, POINTWISE, FIELD...)
  INPUT_QUERY := query(ALIAS, TABLE)
COMPUTE_QUERY := query(ALIAS, reformat(IMMEDIATE, MAPREDUCE)) | query(ALIAS, MAPREDUCE))
         PLAN := plan(STEP...)
         STEP := COMPUTE_QUERY | INPUT_QUERY | PLAN | produces((ALIAS | ACCESS)...)
         ROOT := STEP</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L122-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.protocolize-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.protocolize-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.protocolize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">protocolize(tns, protos...)</code></pre><p>Create a <code>ProtocolizedArray</code> that accesses dimension <code>n</code> with protocol <code>protos[n]</code>, if <code>protos[n]</code> is not nothing. See the documention for <a href="../../guides/iteration_protocols/#Iteration-Protocols">Iteration Protocols</a> for more information. For example, to gallop along the inner dimension of a matrix <code>A</code>, we write <code>A[gallop(i), j]</code>, which becomes <code>protocolize(A, gallop, nothing)[i, j]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/protocolized.jl#L40-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.prove-Tuple{Finch.SymbolicContext, Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.prove-Tuple{Finch.SymbolicContext, Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.prove</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prove(ctx, root; verbose = false)</code></pre><p>use the rules in <code>ctx</code> to attempt to prove that the program <code>root</code> is true. Return false if the program cannot be shown to be true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/prove.jl#L123-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.push_epilogue!-Tuple{Finch.JuliaContext, Any}-reference-listing" href="#Finch.push_epilogue!-Tuple{Finch.JuliaContext, Any}-reference-listing"><code>Finch.push_epilogue!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">push_epilogue!(ctx, thunk)</code></pre><p>Push the thunk onto the epilogue in the currently executing context. The epilogue will be evaluated after the code returned by the given function in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L59-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.push_fields-Tuple{Any}-reference-listing" href="#Finch.push_fields-Tuple{Any}-reference-listing"><code>Finch.push_fields</code></a> — <span class="docstring-category">Method</span></header><section><div><p>push_fields(node)</p><p>This program modifies all <code>EXPR</code> statements in the program, as defined in the following grammar:</p><pre><code class="nohighlight hljs">    LEAF := relabel(ALIAS, FIELD...) |
            table(IMMEDIATE, FIELD...) |
            IMMEDIATE
    EXPR := LEAF |
            reorder(EXPR, FIELD...) |
            relabel(EXPR, FIELD...) |
            mapjoin(IMMEDIATE, EXPR...)</code></pre><p>Pushes all reorder and relabel statements down to LEAF nodes of each EXPR. Output LEAF nodes will match the form <code>reorder(relabel(LEAF, FIELD...), FIELD...)</code>, omitting reorder or relabel if not present as an ancestor of the LEAF in the original EXPR. Tables and immediates will absorb relabels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L74-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.push_preamble!-Tuple{Finch.JuliaContext, Any}-reference-listing" href="#Finch.push_preamble!-Tuple{Finch.JuliaContext, Any}-reference-listing"><code>Finch.push_preamble!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">push_preamble!(ctx, thunk)</code></pre><p>Push the thunk onto the preamble in the currently executing context. The preamble will be evaluated before the code returned by the given function in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L50-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.reassemble_level!-reference-listing" href="#Finch.reassemble_level!-reference-listing"><code>Finch.reassemble_level!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reassemble_level!(lvl, ctx, pos_start, pos_end)</code></pre><p>Set the previously assempled positions from <code>pos_start</code> to <code>pos_end</code> to <code>level_fill_value(lvl)</code>.  Not avaliable on all level types as this presumes updating.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L94-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.refresh-Tuple{}-reference-listing" href="#Finch.refresh-Tuple{}-reference-listing"><code>Finch.refresh</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Finch.refresh()</code></pre><p>Finch caches the code for kernels as soon as they are run. If you modify the Finch compiler after running a kernel, you&#39;ll need to invalidate the Finch caches to reflect these changes by calling <code>Finch.refresh()</code>. This function should only be called at global scope, and never during precompilation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/staging.jl#L74-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.regensym-Tuple{Any}-reference-listing" href="#Finch.regensym-Tuple{Any}-reference-listing"><code>Finch.regensym</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">regensym(ex)</code></pre><p>Give gensyms prettier names by renumbering them. <code>ex</code> is the target Julia expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.release_lock!-Tuple{Finch.AbstractDevice, Any}-reference-listing" href="#Finch.release_lock!-Tuple{Finch.AbstractDevice, Any}-reference-listing"><code>Finch.release_lock!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">release_lock!(dev::AbstractDevice, val)</code></pre><p>Release the lock, val, on the device dev.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/architecture.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.rem_nothrow-Tuple{Any, Any}-reference-listing" href="#Finch.rem_nothrow-Tuple{Any, Any}-reference-listing"><code>Finch.rem_nothrow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rem_nothrow(x, y)</code></pre><p>Returns <code>rem(x, y)</code> normally, returns zero and issues a warning if <code>y</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/special_functions.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.rep_construct-reference-listing" href="#Finch.rep_construct-reference-listing"><code>Finch.rep_construct</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rep_construct(tns, protos...)</code></pre><p>Construct a tensor suitable to hold data with a representation described by <code>tns</code>. Assumes representation is collapsed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/traits.jl#L389-L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.return_type-Tuple{Any, Any, Vararg{Any}}-reference-listing" href="#Finch.return_type-Tuple{Any, Any, Vararg{Any}}-reference-listing"><code>Finch.return_type</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">return_type(algebra, f, arg_types...)</code></pre><p>Give the return type of <code>f</code> when applied to arguments of types <code>arg_types...</code> in <code>algebra</code>. Used to determine output types of functions in the high-level interface. This function falls back to <a href="https://github.com/JuliaLang/julia/blob/46933b8a708453f9caecb8abce88770c4bff675d/base/promotion.jl#L508-L619"><code>Base.promote_op</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/symbolic.jl#L171-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.scale-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.scale-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.scale</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scale(tns, delta...)</code></pre><p>Create a <code>ScaleArray</code> such that <code>scale(tns, delta...)[i...] == tns[i .* delta...]</code>.  The dimensions declared by an OffsetArray are shifted, so that <code>size(scale(tns, delta...)) == size(tns) .* delta</code>.  This is only supported on tensors with real-valued dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/scale.jl#L39-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.scansearch-Union{Tuple{T2}, Tuple{T1}, Tuple{Any, Any, T1, T2}} where {T1&lt;:Integer, T2&lt;:Integer}-reference-listing" href="#Finch.scansearch-Union{Tuple{T2}, Tuple{T1}, Tuple{Any, Any, T1, T2}} where {T1&lt;:Integer, T2&lt;:Integer}-reference-listing"><code>Finch.scansearch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scansearch(v, x, lo, hi)</code></pre><p>return the first value of <code>v</code> greater than or equal to <code>x</code>, within the range <code>lo:hi</code>. Return <code>hi+1</code> if all values are less than <code>x</code>. This implemantation uses an exponential search strategy which involves two steps: 1) searching for binary search bounds via exponential steps rightward 2) binary searching within those bounds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/shims.jl#L14-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_binding!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing" href="#Finch.set_binding!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing"><code>Finch.set_binding!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_binding!(ctx, var, val)</code></pre><p>Set the binding of a variable in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_declared!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing" href="#Finch.set_declared!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing"><code>Finch.set_declared!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_declared!(ctx, var, val)</code></pre><p>Mark a tensor variable as declared in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_fill_value!-Tuple{Tensor, Any}-reference-listing" href="#Finch.set_fill_value!-Tuple{Tensor, Any}-reference-listing"><code>Finch.set_fill_value!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_fill_value!(fbr, init)</code></pre><p>Return a tensor which is equal to <code>fbr</code>, but with the fill (implicit) value set to <code>init</code>.  May reuse memory and render the original tensor unusable when modified.</p><pre><code class="language-julia-repl hljs">julia&gt; A = Tensor(SparseList(Element(0.0), 10), [2.0, 0.0, 3.0, 0.0, 4.0, 0.0, 5.0, 0.0, 6.0, 0.0])
10-Tensor
└─ SparseList (0.0) [1:10]
   ├─ [1]: 2.0
   ├─ [3]: 3.0
   ├─ ⋮
   ├─ [7]: 5.0
   └─ [9]: 6.0

julia&gt; set_fill_value!(A, Inf)
10-Tensor
└─ SparseList (Inf) [1:10]
   ├─ [1]: 2.0
   ├─ [3]: 3.0
   ├─ ⋮
   ├─ [7]: 5.0
   └─ [9]: 6.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/fibers.jl#L166-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_frozen!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing" href="#Finch.set_frozen!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing"><code>Finch.set_frozen!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_frozen!(ctx, var, val)</code></pre><p>Mark a tensor variable as frozen in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_loop_order-reference-listing" href="#Finch.set_loop_order-reference-listing"><code>Finch.set_loop_order</code></a> — <span class="docstring-category">Function</span></header><section><div><p>set<em>loop</em>order(root)</p><p>Heuristically chooses a total order for all loops in the program by inserting <code>reorder</code> statments inside reformat, query, and aggregate nodes.</p><p>Accepts programs of the form:</p><pre><code class="nohighlight hljs">      REORDER := reorder(relabel(ALIAS, FIELD...), FIELD...)
       ACCESS := reorder(relabel(ALIAS, idxs_1::FIELD...), idxs_2::FIELD...) where issubsequence(idxs_1, idxs_2)
    POINTWISE := ACCESS | mapjoin(IMMEDIATE, POINTWISE...) | reorder(IMMEDIATE, FIELD...) | IMMEDIATE
    MAPREDUCE := POINTWISE | aggregate(IMMEDIATE, IMMEDIATE, POINTWISE, FIELD...)
       TABLE  := table(IMMEDIATE, FIELD...)
COMPUTE_QUERY := query(ALIAS, reformat(IMMEDIATE, arg::(REORDER | MAPREDUCE)))
  INPUT_QUERY := query(ALIAS, TABLE)
         STEP := COMPUTE_QUERY | INPUT_QUERY
         ROOT := PLAN(STEP..., produces(ALIAS...))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scheduler/optimize.jl#L470-L488">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_scheduler!-Tuple{Any}-reference-listing" href="#Finch.set_scheduler!-Tuple{Any}-reference-listing"><code>Finch.set_scheduler!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_scheduler!(scheduler)</code></pre><p>Set the current scheduler to <code>scheduler</code>. The scheduler is used by <code>compute</code> to execute lazy tensor programs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/lazy.jl#L457-L462">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.set_thawed!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing" href="#Finch.set_thawed!-Tuple{Finch.ScopeContext, Any, Any}-reference-listing"><code>Finch.set_thawed!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_thawed!(ctx, var, val)</code></pre><p>Mark a tensor variable as thawed in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/scopes.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.simplify-Tuple{Finch.SymbolicContext, Any}-reference-listing" href="#Finch.simplify-Tuple{Finch.SymbolicContext, Any}-reference-listing"><code>Finch.simplify</code></a> — <span class="docstring-category">Method</span></header><section><div><p>simplify(ctx, node)</p><p>simplify the program <code>node</code> using the rules in <code>ctx</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/symbolic/simplify.jl#L233-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.striplines-Tuple{Expr}-reference-listing" href="#Finch.striplines-Tuple{Expr}-reference-listing"><code>Finch.striplines</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">striplines(ex)</code></pre><p>Remove line numbers. <code>ex</code> is the target Julia expression</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.swizzle-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.swizzle-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.swizzle</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">swizzle(tns, dims)</code></pre><p>Create a <code>SwizzleArray</code> to transpose any tensor <code>tns</code> such that</p><pre><code class="nohighlight hljs">    swizzle(tns, dims)[i...] == tns[i[dims]]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/swizzle.jl#L44-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.thaw!-Tuple{Any, Any}-reference-listing" href="#Finch.thaw!-Tuple{Any, Any}-reference-listing"><code>Finch.thaw!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">thaw!(ctx, tns)</code></pre><p>Thaw the read-only virtual tensor <code>tns</code> in the context <code>ctx</code> and return it. Afterwards, the tensor is update-only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L41-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.thaw_level!-reference-listing" href="#Finch.thaw_level!-reference-listing"><code>Finch.thaw_level!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">thaw_level!(ctx, lvl, pos, init)</code></pre><p>Given the last reference position, <code>pos</code>, thaw all fibers within <code>lvl</code> assuming that we have previously assembled and frozen <code>1:pos</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/abstract_level.jl#L77-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.toeplitz-Tuple{Any, Any}-reference-listing" href="#Finch.toeplitz-Tuple{Any, Any}-reference-listing"><code>Finch.toeplitz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">toeplitz(tns, dim)</code></pre><p>Create a <code>ToeplitzArray</code> such that</p><pre><code class="nohighlight hljs">    Toeplitz(tns, dim)[i...] == tns[i[1:dim-1]..., i[dim] + i[dim + 1], i[dim + 2:end]...]</code></pre><p>The ToplitzArray can be thought of as adding a dimension that shifts another dimension of the original tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/toeplitz.jl#L56-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.unblock-Tuple{Expr}-reference-listing" href="#Finch.unblock-Tuple{Expr}-reference-listing"><code>Finch.unblock</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unblock(ex)</code></pre><p>Flatten any redundant blocks into a single block, over the whole expression. <code>ex</code> is the target Julia expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L42-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.unfurl-Tuple{Any, Finch.Furlable, Any, Any, Vararg{Any}}-reference-listing" href="#Finch.unfurl-Tuple{Any, Finch.Furlable, Any, Any, Vararg{Any}}-reference-listing"><code>Finch.unfurl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unfurl(ctx, tns, ext, protos...)</code></pre><p>Return an array object (usually a looplet nest) for lowering the virtual tensor <code>tns</code>. <code>ext</code> is the extent of the looplet. <code>protos</code> is the list of protocols that should be used for each index, but one doesn&#39;t need to unfurl all the indices at once.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/looplets/unfurl.jl#L15-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.unquote_literals-Tuple{Any}-reference-listing" href="#Finch.unquote_literals-Tuple{Any}-reference-listing"><code>Finch.unquote_literals</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unquote_literals(ex)</code></pre><p>unquote QuoteNodes when this doesn&#39;t change the semantic meaning. <code>ex</code> is the target Julia expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.unresolve-Tuple{Any}-reference-listing" href="#Finch.unresolve-Tuple{Any}-reference-listing"><code>Finch.unresolve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unresolve(ex)</code></pre><p>Unresolve function literals into function symbols. <code>ex</code> is the target Julia expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/postprocess.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtual_call-Tuple{Any, Any, Vararg{Any}}-reference-listing" href="#Finch.virtual_call-Tuple{Any, Any, Vararg{Any}}-reference-listing"><code>Finch.virtual_call</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">virtual_call(ctx, f, a...)</code></pre><p>Given the virtual arguments <code>a...</code>, and a literal function <code>f</code>, return a virtual object representing the result of the function call. If the function is not foldable, return nothing. This function is used so that we can call e.g. tensor constructors in finch code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/evaluate.jl#L56-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtual_eltype-reference-listing" href="#Finch.virtual_eltype-reference-listing"><code>Finch.virtual_eltype</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_eltype(arr)</code></pre><p>Return the element type of the virtual tensor <code>arr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L64-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtual_fill_value-reference-listing" href="#Finch.virtual_fill_value-reference-listing"><code>Finch.virtual_fill_value</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual fill_value(arr)</code></pre><p>Return the initializer for virtual array <code>arr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtual_moveto-reference-listing" href="#Finch.virtual_moveto-reference-listing"><code>Finch.virtual_moveto</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_moveto(device, arr)</code></pre><p>If the virtual array is not on the given device, copy the array to that device. This function may modify underlying data arrays, but cannot change the virtual itself. This function is used to move data to the device before a kernel is launched.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L107-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtual_resize!-reference-listing" href="#Finch.virtual_resize!-reference-listing"><code>Finch.virtual_resize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_resize!(ctx, tns, dims...)</code></pre><p>Resize <code>tns</code> in the context <code>ctx</code>. This is a function similar in spirit to <code>Base.resize!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L91-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtual_size-reference-listing" href="#Finch.virtual_size-reference-listing"><code>Finch.virtual_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_size(ctx, tns)</code></pre><p>Return a tuple of the dimensions of <code>tns</code> in the context <code>ctx</code>. This is a function similar in spirit to <code>Base.axes</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/abstract_tensor.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.virtualize-NTuple{4, Any}-reference-listing" href="#Finch.virtualize-NTuple{4, Any}-reference-listing"><code>Finch.virtualize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">virtualize(ctx, ex, T, [tag])</code></pre><p>Return the virtual program corresponding to the Julia expression <code>ex</code> of type <code>T</code> in the <code>JuliaContext</code> <code>ctx</code>. Implementaters may support the optional <code>tag</code> argument is used to name the resulting virtual variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/environment.jl#L75-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.window-Tuple{Any, Vararg{Any}}-reference-listing" href="#Finch.window-Tuple{Any, Vararg{Any}}-reference-listing"><code>Finch.window</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">window(tns, dims)</code></pre><p>Create a <code>WindowedArray</code> which represents a view into another tensor</p><pre><code class="nohighlight hljs">    window(tns, dims)[i...] == tns[dim[1][i], dim[2][i], ...]</code></pre><p>The windowed array restricts the new dimension to the dimension of valid indices of each <code>dim</code>. The <code>dims</code> may also be <code>nothing</code> to represent a full view of the underlying dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/tensors/combinators/windowed.jl#L43-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.with_scheduler-Tuple{Any, Any}-reference-listing" href="#Finch.with_scheduler-Tuple{Any, Any}-reference-listing"><code>Finch.with_scheduler</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">with_scheduler(f, scheduler)</code></pre><p>Execute <code>f</code> with the current scheduler set to <code>scheduler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/lazy.jl#L472-L476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.wrapperize-Tuple{Finch.AbstractCompiler, Any}-reference-listing" href="#Finch.wrapperize-Tuple{Finch.AbstractCompiler, Any}-reference-listing"><code>Finch.wrapperize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wrapperize(ctx, root)</code></pre><p>Convert index expressions in the program <code>root</code> to wrapper arrays, according to the rules in <code>get_wrapper_rules</code>. By default, the following transformations are performed:</p><pre><code class="language-julia hljs">A[i - j] =&gt; A[i + (-j)]
A[3 * i] =&gt; ScaleArray(A, (3,))[i]
A[i * j] =&gt; ProductArray(A, 1)[i, j]
A[i + 1] =&gt; OffsetArray(A, (1,))[i]
A[i + j] =&gt; ToeplitzArray(A, 1)[i, j]
A[~i] =&gt; PermissiveArray(A, 1)[i]</code></pre><p>The loop binding order may be used to determine which index comes first in an expression like <code>A[i + j]</code>. Thus, <code>for i=:,j=:; ... A[i + j]</code> will result in <code>ToeplitzArray(A, 1)[j, i]</code>, but <code>for j=:,i=:; ... A[i + j]</code> results in <code>ToeplitzArray(A, 1)[i, j]</code>. <code>wrapperize</code> runs before dimensionalization, so resulting raw indices may participate in dimensionalization according to the semantics of the wrapper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/transforms/wrapperize.jl#L185-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@barrier-Tuple-reference-listing" href="#Finch.@barrier-Tuple-reference-listing"><code>Finch.@barrier</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@barrier args... ex</code></pre><p>Wrap <code>ex</code> in a let block that captures all free variables in <code>ex</code> that are bound in the arguments. This is useful for ensuring that the variables in <code>ex</code> are not mutated by the arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/shims.jl#L59-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@closure-Tuple{Any}-reference-listing" href="#Finch.@closure-Tuple{Any}-reference-listing"><code>Finch.@closure</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@closure closure_expression</code></pre><p>Wrap the closure definition <code>closure_expression</code> in a let block to encourage the julia compiler to generate improved type information.  For example:</p><pre><code class="language-julia hljs">callfunc(f) = f()

function foo(n)
   for i=1:n
       if i &gt;= n
           # Unlikely event - should be fast.  However, capture of `i` inside
           # the closure confuses the julia-0.6 compiler and causes it to box
           # the variable `i`, leading to a 100x performance hit if you remove
           # the `@closure`.
           callfunc(@closure ()-&gt;println(&quot;Hello $i&quot;))
       end
   end
end</code></pre><p>There&#39;s nothing nice about this - it&#39;s a heuristic workaround for some inefficiencies in the type information inferred by the julia 0.6 compiler. However, it can result in large speedups in many cases, without the need to restructure the code to avoid the closure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/shims.jl#L101-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@einsum-Tuple-reference-listing" href="#Finch.@einsum-Tuple-reference-listing"><code>Finch.@einsum</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@einsum tns[idxs...] &lt;&lt;op&gt;&gt;= ex...</code></pre><p>Construct an einsum expression that computes the result of applying <code>op</code> to the tensor <code>tns</code> with the indices <code>idxs</code> and the tensors in the expression <code>ex</code>. The result is stored in the variable <code>tns</code>.</p><p><code>ex</code> may be any pointwise expression consisting of function calls and tensor references of the form <code>tns[idxs...]</code>, where <code>tns</code> and <code>idxs</code> are symbols.</p><p>The <code>&lt;&lt;op&gt;&gt;</code> operator can be any binary operator that is defined on the element type of the expression <code>ex</code>.</p><p>The einsum will evaluate the pointwise expression <code>tns[idxs...] &lt;&lt;op&gt;&gt;= ex...</code> over all combinations of index values in <code>tns</code> and the tensors in <code>ex</code>.</p><p>Here are a few examples:</p><pre><code class="nohighlight hljs">@einsum C[i, j] += A[i, k] * B[k, j]
@einsum C[i, j, k] += A[i, j] * B[j, k]
@einsum D[i, k] += X[i, j] * Y[j, k]
@einsum J[i, j] = H[i, j] * I[i, j]
@einsum N[i, j] = K[i, k] * L[k, j] - M[i, j]
@einsum R[i, j] &lt;&lt;max&gt;&gt;= P[i, k] + Q[k, j]
@einsum x[i] = A[i, j] * x[j]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/interface/einsum.jl#L135-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@finch-Tuple-reference-listing" href="#Finch.@finch-Tuple-reference-listing"><code>Finch.@finch</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@finch [options...] prgm</code></pre><p>Run a finch program <code>prgm</code>. The syntax for a finch program is a set of nested loops, statements, and branches over pointwise array assignments. For example, the following program computes the sum of two arrays <code>A = B + C</code>:</p><pre><code class="language-julia hljs">@finch begin
    A .= 0
    for i = _
        A[i] = B[i] + C[i]
    end
    return A
end</code></pre><p>Finch programs are composed using the following syntax:</p><ul><li><code>arr .= 0</code>: an array declaration initializing arr to zero.</li><li><code>arr[inds...]</code>: an array access, the array must be a variable and each index may be another finch expression.</li><li><code>x + y</code>, <code>f(x, y)</code>: function calls, where <code>x</code> and <code>y</code> are finch expressions.</li><li><code>arr[inds...] = ex</code>: an array assignment expression, setting <code>arr[inds]</code> to the value of <code>ex</code>.</li><li><code>arr[inds...] += ex</code>: an incrementing array expression, adding <code>ex</code> to <code>arr[inds]</code>. <code>*, &amp;, |</code>, are supported.</li><li><code>arr[inds...] &lt;&lt;min&gt;&gt;= ex</code>: a incrementing array expression with a custom operator, e.g. <code>&lt;&lt;min&gt;&gt;</code> is the minimum operator.</li><li><code>for i = _ body end</code>: a loop over the index <code>i</code>, where <code>_</code> is computed from array access with <code>i</code> in <code>body</code>.</li><li><code>if cond body end</code>: a conditional branch that executes only iterations where <code>cond</code> is true.</li><li><code>return (tnss...,)</code>: at global scope, exit the program and return the tensors <code>tnss</code> with their new dimensions. By default, any tensor declared in global scope is returned.</li></ul><p>Symbols are used to represent variables, and their values are taken from the environment. Loops introduce index variables into the scope of their bodies.</p><p>Finch uses the types of the arrays and symbolic analysis to discover program optimizations. If <code>B</code> and <code>C</code> are sparse array types, the program will only run over the nonzeros of either.</p><p>Semantically, Finch programs execute every iteration. However, Finch can use sparsity information to reliably skip iterations when possible.</p><p><code>options</code> are optional keyword arguments:</p><ul><li><code>algebra</code>: the algebra to use for the program. The default is <code>DefaultAlgebra()</code>.</li><li><code>mode</code>: the optimization mode to use for the program. Possible modes are:<ul><li><code>:debug</code>: run the program in debug mode, with bounds checking and better error handling.</li><li><code>:safe</code>: run the program in safe mode, with modest checks for performance and correctness.</li><li><code>:fast</code>: run the program in fast mode, with no checks or warnings, this mode is for power users.</li></ul>The default is <code>:safe</code>.</li></ul><p>See also: <a href="../../guides/calling_finch/#Finch.@finch_code"><code>@finch_code</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/execute.jl#L120-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@finch_code-Tuple-reference-listing" href="#Finch.@finch_code-Tuple-reference-listing"><code>Finch.@finch_code</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>@finch_code [options...] prgm</p><p>Return the code that would be executed in order to run a finch program <code>prgm</code>.</p><p>See also: <a href="../../guides/calling_finch/#Finch.@finch"><code>@finch</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/execute.jl#L197-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@finch_kernel-Tuple-reference-listing" href="#Finch.@finch_kernel-Tuple-reference-listing"><code>Finch.@finch_kernel</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@finch_kernel [options...] fname(args...) = prgm</code></pre><p>Return a definition for a function named <code>fname</code> which executes <code>@finch prgm</code> on the arguments <code>args</code>. <code>args</code> should be a list of variables holding representative argument instances or types.</p><p>See also: <a href="../../guides/calling_finch/#Finch.@finch"><code>@finch</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/execute.jl#L249-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.@staged-Tuple{Any}-reference-listing" href="#Finch.@staged-Tuple{Any}-reference-listing"><code>Finch.@staged</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">Finch.@staged</code></pre><p>This function is used internally in Finch in lieu of @generated functions. It ensures the first Finch invocation runs in the latest world, and leaves hooks so that subsequent calls to <a href="../../guides/user-defined_functions/#Finch.refresh"><code>Finch.refresh</code></a> can update the world and invalidate old versions. If the body contains closures, this macro uses an eval and invokelatest strategy. Otherwise, it uses a generated function. This macro does not support type parameters, varargs, or keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/util/staging.jl#L11-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.access-reference-listing" href="#Finch.FinchNotation.access-reference-listing"><code>Finch.FinchNotation.access</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">access(tns, mode, idx...)</code></pre><p>Finch AST expression representing the value of tensor <code>tns</code> at the indices <code>idx...</code>. The <code>mode</code> differentiates between reads or updates and whether the access is in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L91-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.assign-reference-listing" href="#Finch.FinchNotation.assign-reference-listing"><code>Finch.FinchNotation.assign</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">assign(lhs, op, rhs)</code></pre><p>Finch AST statement that updates the value of <code>lhs</code> to <code>op(lhs, rhs)</code>. Overwriting is accomplished with the function <code>overwrite(lhs, rhs) = rhs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L124-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.block-reference-listing" href="#Finch.FinchNotation.block-reference-listing"><code>Finch.FinchNotation.block</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">block(bodies...)</code></pre><p>Finch AST statement that executes each of it&#39;s arguments in turn. If the body is not a block, replaces accesses to tensors in the body with instantiate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L161-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.cached-reference-listing" href="#Finch.FinchNotation.cached-reference-listing"><code>Finch.FinchNotation.cached</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">cached(val, ref)</code></pre><p>Finch AST expression <code>val</code>, equivalent to the quoted expression <code>ref</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L100-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.call-reference-listing" href="#Finch.FinchNotation.call-reference-listing"><code>Finch.FinchNotation.call</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">call(op, args...)</code></pre><p>Finch AST expression for the result of calling the function <code>op</code> on <code>args...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.declare-reference-listing" href="#Finch.FinchNotation.declare-reference-listing"><code>Finch.FinchNotation.declare</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">declare(tns, init)</code></pre><p>Finch AST statement that declares <code>tns</code> with an initial value <code>init</code> in the current scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L140-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.define-reference-listing" href="#Finch.FinchNotation.define-reference-listing"><code>Finch.FinchNotation.define</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">define(lhs, rhs, body)</code></pre><p>Finch AST statement that defines <code>lhs</code> as having the value <code>rhs</code> in <code>body</code>. A new scope is introduced to evaluate <code>body</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L132-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.freeze-reference-listing" href="#Finch.FinchNotation.freeze-reference-listing"><code>Finch.FinchNotation.freeze</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">freeze(tns)</code></pre><p>Finch AST statement that freezes <code>tns</code> in the current scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L147-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.index-reference-listing" href="#Finch.FinchNotation.index-reference-listing"><code>Finch.FinchNotation.index</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">index(name)</code></pre><p>Finch AST expression for an index named <code>name</code>. Each index must be quantified by a corresponding <code>loop</code> which iterates over all values of the index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L48-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.literal-reference-listing" href="#Finch.FinchNotation.literal-reference-listing"><code>Finch.FinchNotation.literal</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">literal(val)</code></pre><p>Finch AST expression for the literal value <code>val</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.loop-reference-listing" href="#Finch.FinchNotation.loop-reference-listing"><code>Finch.FinchNotation.loop</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">loop(idx, ext, body)</code></pre><p>Finch AST statement that runs <code>body</code> for each value of <code>idx</code> in <code>ext</code>. Tensors in <code>body</code> must have ranges that agree with <code>ext</code>. A new scope is introduced to evaluate <code>body</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L107-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.sieve-reference-listing" href="#Finch.FinchNotation.sieve-reference-listing"><code>Finch.FinchNotation.sieve</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">sieve(cond, body)</code></pre><p>Finch AST statement that only executes <code>body</code> if <code>cond</code> is true. A new scope is introduced to evaluate <code>body</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L116-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.tag-reference-listing" href="#Finch.FinchNotation.tag-reference-listing"><code>Finch.FinchNotation.tag</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">tag(var, bind)</code></pre><p>Finch AST expression for a global variable <code>var</code> with the value <code>bind</code>. Because the finch compiler cannot pass variable state from the program domain to the type domain directly, the <code>tag</code> type represents a value <code>bind</code> referred to by a variable named <code>bind</code>. All <code>tag</code> in the same program must agree on the value of variables, and only one value will be virtualized.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L73-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.thaw-reference-listing" href="#Finch.FinchNotation.thaw-reference-listing"><code>Finch.FinchNotation.thaw</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">thaw(tns)</code></pre><p>Finch AST statement that thaws <code>tns</code> in the current scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.value-reference-listing" href="#Finch.FinchNotation.value-reference-listing"><code>Finch.FinchNotation.value</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">value(val, type)</code></pre><p>Finch AST expression for host code <code>val</code> expected to evaluate to a value of type <code>type</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.variable-reference-listing" href="#Finch.FinchNotation.variable-reference-listing"><code>Finch.FinchNotation.variable</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">variable(name)</code></pre><p>Finch AST expression for a variable named <code>name</code>. The variable can be looked up in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L56-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.virtual-reference-listing" href="#Finch.FinchNotation.virtual-reference-listing"><code>Finch.FinchNotation.virtual</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">virtual(val)</code></pre><p>Finch AST expression for an object <code>val</code> which has special meaning to the compiler. This type is typically used for tensors, as it allows users to specify the tensor&#39;s shape and data type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L64-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.yieldbind-reference-listing" href="#Finch.FinchNotation.yieldbind-reference-listing"><code>Finch.FinchNotation.yieldbind</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">yieldbind(args...)</code></pre><p>Finch AST statement that sets the result of the program to the values of variables <code>args...</code>. Subsequent statements will not affect the result of the program.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L170-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.Dimensionless-reference-listing" href="#Finch.FinchNotation.Dimensionless-reference-listing"><code>Finch.FinchNotation.Dimensionless</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dimensionless()</code></pre><p>A singleton type representing the lack of a dimension.  This is used in place of a dimension when we want to avoid dimensionality checks. In the <code>@finch</code> macro, you can write <code>Dimensionless()</code> with an underscore as <code>for i = _</code>, allowing finch to pick up the loop bounds from the tensors automatically.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/syntax.jl#L98-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.FinchNode-reference-listing" href="#Finch.FinchNotation.FinchNode-reference-listing"><code>Finch.FinchNotation.FinchNode</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FinchNode</code></pre><p>A Finch IR node, used to represent an imperative, physical Finch program.</p><p>The FinchNode struct represents many different Finch IR nodes. The nodes are differentiated by a <code>FinchNotation.FinchNodeKind</code> enum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L179-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.extrude-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.extrude-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.extrude</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extrude(i)</code></pre><p>The extrude protocol declares that the tensor update happens in order and only once, so that reduction loops occur below the extrude loop. It is not usually necessary to declare an extrude protocol, but it is used internally to reason about tensor format requirements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/protocols.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.finch_leaf-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.finch_leaf-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.finch_leaf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">finch_leaf(x)</code></pre><p>Return a terminal finch node wrapper around <code>x</code>. A convenience function to determine whether <code>x</code> should be understood by default as a literal, value, or virtual.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L387-L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.follow-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.follow-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.follow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">follow(i)</code></pre><p>The follow protocol ignores the structure of the tensor. By itself, the follow protocol iterates over each value of the tensor in order, looking it up with random access.  The follow protocol may specialize on e.g. the zero value of the tensor, but does not specialize on the structure of the tensor. This enables efficient random access and avoids large code sizes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/protocols.jl#L24-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.gallop-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.gallop-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.gallop</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gallop(i)</code></pre><p>The gallop protocol iterates over each pattern element of a tensor, leading the iteration and superceding the priority of other tensors. Mutual leading is possible, where we fast-forward to the largest step between either leader.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/protocols.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.initwrite-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.initwrite-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.initwrite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initwrite(z)(a, b)</code></pre><p><code>initwrite(z)</code> is a function which may assert that <code>a</code> <a href="https://docs.julialang.org/en/v1/base/base/#Base.isequal"><code>isequal</code></a> to <code>z</code>, and <code>returns</code>b<code>.  By default,</code>lhs[] = rhs<code>is equivalent to</code>lhs[] &lt;&lt;initwrite(fill_value(lhs))&gt;&gt;= rhs`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/syntax.jl#L67-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isconstant-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isconstant-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isconstant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isconstant(node)</code></pre><p>Returns true if the node can be expected to be constant within the current finch context</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L217-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isindex-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isindex-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isindex(node)</code></pre><p>Returns true if the node is a finch index</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L238-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isliteral-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isliteral-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isliteral</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isliteral(node)</code></pre><p>Returns true if the node is a finch literal</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L203-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isstateful-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isstateful-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isstateful</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isstateful(node)</code></pre><p>Returns true if the node is a finch statement, and false if the node is an index expression. Typically, statements specify control flow and expressions describe values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L194-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isvalue-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isvalue-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isvalue</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isvalue(node)</code></pre><p>Returns true if the node is a finch value</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L210-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isvariable-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isvariable-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isvariable</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isvariable(node)</code></pre><p>Returns true if the node is a finch variable</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L231-L235">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.isvirtual-Tuple{Finch.FinchNotation.FinchNode}-reference-listing" href="#Finch.FinchNotation.isvirtual-Tuple{Finch.FinchNotation.FinchNode}-reference-listing"><code>Finch.FinchNotation.isvirtual</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isvirtual(node)</code></pre><p>Returns true if the node is a finch virtual</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/nodes.jl#L224-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.laminate-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.laminate-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.laminate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">laminate(i)</code></pre><p>The laminate protocol declares that the tensor update may happen out of order and multiple times. It is not usually necessary to declare a laminate protocol, but it is used internally to reason about tensor format requirements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/protocols.jl#L38-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.overwrite-Tuple{Any, Any}-reference-listing" href="#Finch.FinchNotation.overwrite-Tuple{Any, Any}-reference-listing"><code>Finch.FinchNotation.overwrite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">overwrite(z)(a, b)</code></pre><p><code>overwrite(z)</code> is a function which returns <code>b</code> always. <code>lhs[] := rhs</code> is equivalent to <code>lhs[] &lt;&lt;overwrite&gt;&gt;= rhs</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; a = Tensor(SparseList(Element(0.0)), [0, 1.1, 0, 4.4, 0])
5-Tensor
└─ SparseList (0.0) [1:5]
   ├─ [2]: 1.1
   └─ [4]: 4.4

julia&gt; x = Scalar(0.0); @finch for i=_; x[] &lt;&lt;overwrite&gt;&gt;= a[i] end;

julia&gt; x[]
0.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/syntax.jl#L77-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.walk-Tuple{Any}-reference-listing" href="#Finch.FinchNotation.walk-Tuple{Any}-reference-listing"><code>Finch.FinchNotation.walk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">walk(i)</code></pre><p>The walk protocol usually iterates over each pattern element of a tensor in order. Note that the walk protocol &quot;imposes&quot; the structure of its argument on the kernel, so that we specialize the kernel to the structure of the tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/willow-ahrens/Finch.jl/blob/6e904724a86bf76ed3c980b102643b29b4a4301f/src/FinchNotation/protocols.jl#L6-L11">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../guides/benchmarking_tips/">« Benchmarking Tips</a><a class="docs-footer-nextpage" href="../internals/virtualization/">Virtualization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 14 June 2024 23:04">Friday 14 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
